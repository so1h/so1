JWasm v2.12pre, Nov 27 2013
raton_ms.asm
                                	.286
                                	ifndef	??version
                                	else
                                $comm	macro	name,dist,size,count
 >                              	comm	dist name[size]:BYTE:count
 >                              	endm
                                	endif
00000000                        _TEXT	segment byte public 'CODE'
                                _TEXT	ends
                                DGROUP	group	_DATA,_BSS
                                	assume	cs:_TEXT,ds:DGROUP
00000000                        _DATA	segment word public 'DATA'
00000000                        d@	label	byte
00000000                        d@w	label	word
00000000                        _DATA	ends
00000000                        _BSS	segment word public 'BSS'
00000000                        b@	label	byte
00000000                        b@w	label	word
00000000                        _BSS	ends
00000000                        _DATA	segment word public 'DATA'
00000000                        _ptrIndProcesoActual	label	dword
00000000  00                    	db	0
00000001  00                    	db	0
00000002  00                    	db	0
00000003  00                    	db	0
00000004                        _ptrTramaProceso	label	dword
00000004  00                    	db	0
00000005  00                    	db	0
00000006  00                    	db	0
00000007  00                    	db	0
00000008                        _ptrActivarAlEpilogo	label	dword
00000008  00                    	db	0
00000009  00                    	db	0
0000000A  00                    	db	0
0000000B  00                    	db	0
0000000C                        _ptrDescProceso	label	dword
0000000C  00                    	db	0
0000000D  00                    	db	0
0000000E  00                    	db	0
0000000F  00                    	db	0
00000010                        _tamDescProceso	label	word
00000010  00                    	db	0
00000011  00                    	db	0
00000012                        _ptrDescFichero	label	dword
00000012  00                    	db	0
00000013  00                    	db	0
00000014  00                    	db	0
00000015  00                    	db	0
00000016                        _ptrDescRecurso	label	dword
00000016  00                    	db	0
00000017  00                    	db	0
00000018  00                    	db	0
00000019  00                    	db	0
0000001A                        _ptrC2cPFR	label	dword
0000001A  00                    	db	0
0000001B  00                    	db	0
0000001C  00                    	db	0
0000001D  00                    	db	0
0000001E                        _ptrNivelActivacionSO1	label	dword
0000001E  00                    	db	0
0000001F  00                    	db	0
00000020  00                    	db	0
00000021  00                    	db	0
00000022                        _ptrEnHalt	label	dword
00000022  00                    	db	0
00000023  00                    	db	0
00000024  00                    	db	0
00000025  00                    	db	0
00000026                        _ptrHayTic	label	dword
00000026  00                    	db	0
00000027  00                    	db	0
00000028  00                    	db	0
00000029  00                    	db	0
0000002A                        _ptrCcbAlEpilogo	label	dword
0000002A  00                    	db	0
0000002B  00                    	db	0
0000002C  00                    	db	0
0000002D  00                    	db	0
0000002E                        _ptrSS_Proceso	label	dword
0000002E  00                    	db	0
0000002F  00                    	db	0
00000030  00                    	db	0
00000031  00                    	db	0
00000032                        _ptrSP_Proceso	label	dword
00000032  00                    	db	0
00000033  00                    	db	0
00000034  00                    	db	0
00000035  00                    	db	0
00000036                        _SP0_SO1	label	word
00000036  00                    	db	0
00000037  00                    	db	0
00000038                        _ptrContRodajas	label	dword
00000038  00                    	db	0
00000039  00                    	db	0
0000003A  00                    	db	0
0000003B  00                    	db	0
0000003C                        _ptrContTicsRodaja	label	dword
0000003C  00                    	db	0
0000003D  00                    	db	0
0000003E  00                    	db	0
0000003F  00                    	db	0
00000040                        _ptrVIOrg	label	dword
00000040  00                    	db	0
00000041  00                    	db	0
00000042  00                    	db	0
00000043  00                    	db	0
00000044                        _sigProceso	label	dword
00000044  00                    	db	0
00000045  00                    	db	0
00000046  00                    	db	0
00000047  00                    	db	0
00000048                        _activarProceso	label	dword
00000048  00                    	db	0
00000049  00                    	db	0
0000004A  00                    	db	0
0000004B  00                    	db	0
0000004C                        _buscarNuevoProcesoActual	label	dword
0000004C  00                    	db	0
0000004D  00                    	db	0
0000004E  00                    	db	0
0000004F  00                    	db	0
00000050                        _bloquearProcesoActual	label	dword
00000050  00                    	db	0
00000051  00                    	db	0
00000052  00                    	db	0
00000053  00                    	db	0
00000054                        _rec_raton	label	word
00000054  00                    	db	0
00000055  00                    	db	0
00000056                        _bloqueadosRaton	label	word
00000056  00                    	db	0
00000057  00                    	db	0
00000058  00                    	db	0
00000059  00                    	db	0
0000005A  00                    	db	0
0000005B  00                    	db	0
0000005C  00                    	db	0
0000005D  00                    	db	0
0000005E  00                    	db	0
0000005F  00                    	db	0
00000060                        _e2BloqueadosRaton	label	word
00000060  00                    	db	0
00000061  00                    	db	0
00000062  00                    	db	0
00000063  00                    	db	0
00000064  000000000000000000    	db	64 dup (0)
000000A4                        _nbytesProceso	label	word
000000A4  00                    	db	0
000000A5  00                    	db	0
000000A6  000000000000000000    	db	30 dup (0)
000000C4                        _dirProceso	label	dword
000000C4  00                    	db	0
000000C5  00                    	db	0
000000C6  00                    	db	0
000000C7  00                    	db	0
000000C8  000000000000000000    	db	60 dup (0)
00000104                        _inB	label	word
00000104  00                    	db	0
00000105  00                    	db	0
00000106                        _B	label	byte
00000106  00                    	db	0
00000107  00                    	db	0
00000108  00                    	db	0
00000109                        _er	label	word
00000109  00                    	db	0
0000010A  00                    	db	0
0000010B  00                    	db	0
0000010C  00                    	db	0
0000010D  00                    	db	0
0000010E  00                    	db	0
0000010F  00                    	db	0
00000110  00                    	db	0
00000111  00                    	db	0
00000112  00                    	db	0
00000113  00                    	db	0
00000114  00                    	db	0
00000115  00                    	db	0
00000116  00                    	db	0
00000117  00                    	db	0
00000118  00                    	db	0
00000119  00                    	db	0
0000011A  00                    	db	0
0000011B  00                    	db	0
0000011C  00                    	db	0
0000011D  00                    	db	0
0000011E  00                    	db	0
0000011F  00                    	db	0
00000120  00                    	db	0
00000121  00                    	db	0
00000122  00                    	db	0
00000123  00                    	db	0
00000124  00                    	db	0
00000125  00                    	db	0
00000126  00                    	db	0
00000127  00                    	db	0
00000128  00                    	db	0
00000129  00                    	db	0
0000012A  00                    	db	0
0000012B  00                    	db	1 dup (0)
0000012C                        _XAux	label	word
0000012C  00                    	db	0
0000012D  00                    	db	0
0000012E                        _YAux	label	word
0000012E  00                    	db	0
0000012F  00                    	db	0
00000130                        _FAntCursor	label	word
00000130  00                    	db	0
00000131  00                    	db	0
00000132                        _CAntCursor	label	word
00000132  00                    	db	0
00000133  00                    	db	0
00000134                        _atrAux	label	byte
00000134  00                    	db	0
00000135  00                    	db	1 dup (0)
00000136                        _cursorRatonActivo	label	word
00000136  01                    	db	1
00000137  00                    	db	0
00000138                        _moviendo	label	word
00000138  00                    	db	0
00000139  00                    	db	0
0000013A                        _redimensionando	label	word
0000013A  00                    	db	0
0000013B  00                    	db	0
0000013C                        _primerClick	label	word
0000013C  01                    	db	1
0000013D  00                    	db	0
0000013E                        _contTics2Click	label	word
0000013E  00                    	db	0
0000013F  00                    	db	0
00000140                        _huboInt	label	word
00000140  01                    	db	1
00000141  00                    	db	0
00000142                        _primeraInt	label	word
00000142  01                    	db	1
00000143  00                    	db	0
00000144                        _DATA	ends
00000000                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
00000000                        _inicEstadoRaton	proc	near
                                   ;	
                                   ;	void inicEstadoRaton ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    er.S0 = 0x00 ;                                    /* byte estado 8042  */
                                   ;	
00000000  C606090100            	mov	byte ptr DGROUP:_er,0
                                   ;	
                                   ;	    er.B0 = 0x00 ;                                    /* Byte 0 = 00SS1MRL */
                                   ;	
00000005  C6060A0100            	mov	byte ptr DGROUP:_er+1,0
                                   ;	
                                   ;	    er.B1 = 0x00 ;                                    /* Byte 1 = X        */
                                   ;	
0000000A  C6060B0100            	mov	byte ptr DGROUP:_er+2,0
                                   ;	
                                   ;	    er.B2 = 0x00 ;                                    /* Byte 2 = Y        */
                                   ;	
0000000F  C6060C0100            	mov	byte ptr DGROUP:_er+3,0
                                   ;	
                                   ;	    er.W0 = 0x0000 ;
                                   ;	
00000014  C7060D010000          	mov	word ptr DGROUP:_er+4,0
                                   ;	
                                   ;	    er.X = maxX/2 ;
                                   ;	
0000001A  C70613014001          	mov	word ptr DGROUP:_er+10,320
                                   ;	
                                   ;	//  er.Y = maxY/2 ; 
                                   ;	    er.Y = (maxYAct + 1)/2 ;	
                                   ;	
00000020  33C0                  	xor	ax,ax
00000022  8EC0                  	mov	es,ax
00000024  26A08404              	mov	al,byte ptr es:[1156]
00000028  B400                  	mov	ah,0
0000002A  40                    	inc	ax
0000002B  C1E003                	shl	ax,3
0000002E  40                    	inc	ax
0000002F  99                    	cwd	
00000030  2BC2                  	sub	ax,dx
00000032  D1F8                  	sar	ax,1
00000034  A31501                	mov	word ptr DGROUP:_er+12,ax
                                   ;	
                                   ;	    er.F = er.Y >> 3 ;                                          /* F = Y/8 */
                                   ;	
00000037  A11501                	mov	ax,word ptr DGROUP:_er+12
0000003A  C1F803                	sar	ax,3
0000003D  A31701                	mov	word ptr DGROUP:_er+14,ax
                                   ;	
                                   ;	    er.C = er.X >> 3 ;                                          /* C = X/8 */
                                   ;	
00000040  A11301                	mov	ax,word ptr DGROUP:_er+10
00000043  C1F803                	sar	ax,3
00000046  A31901                	mov	word ptr DGROUP:_er+16,ax
                                   ;	
                                   ;	    er.botonIz = FALSE ;
                                   ;	
00000049  C7061B010000          	mov	word ptr DGROUP:_er+18,0
                                   ;	
                                   ;	    er.botonDe = FALSE ;
                                   ;	
0000004F  C7061D010000          	mov	word ptr DGROUP:_er+20,0
                                   ;	
                                   ;	    er.botonMe = FALSE ;
                                   ;	
00000055  C7061F010000          	mov	word ptr DGROUP:_er+22,0
                                   ;	
                                   ;	
                                   ;	    primeraInt = TRUE ;
                                   ;	
0000005B  C70642010100          	mov	word ptr DGROUP:_primeraInt,1
                                   ;	
                                   ;	    cursorRatonActivo = TRUE ;
                                   ;	
00000061  C70636010100          	mov	word ptr DGROUP:_cursorRatonActivo,1
                                   ;	
                                   ;	    primerClick = TRUE ;
                                   ;	
00000067  C7063C010100          	mov	word ptr DGROUP:_primerClick,1
                                   ;	
                                   ;	    contTics2Click = 0 ;
                                   ;	
0000006D  C7063E010000          	mov	word ptr DGROUP:_contTics2Click,0
                                   ;	
                                   ;	}
                                   ;	
00000073                        	ret	
00000074                        _inicEstadoRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000074                        _leerEstadoRaton	proc	near
                                   ;	
                                   ;	bool_t leerEstadoRaton ( estadoRaton_t far * estado )
                                   ;	
00000074  55                    	push	bp
00000075  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	{
                                   ;	    memcpy(estado, &er, sizeof(estadoRaton_t)) ;
                                   ;	
00000077  6A22                  	push	34
00000079  1E                    	push	ds
0000007A  680901                	push	offset DGROUP:_er
0000007D  FF7606                	push	word ptr [bp+6]
00000080  FF7604                	push	word ptr [bp+4]
00000083  E80000                	call	near ptr _memcpy
00000086  83C40A                	add	sp,10
                                   ;	
                                   ;	    if (huboInt)
                                   ;	
00000089  833E400100            	cmp	word ptr DGROUP:_huboInt,0
0000008E  740D                  	je	short @2@5
                                   ;	
                                   ;	    {
                                   ;	        huboInt = FALSE ;
                                   ;	
00000090  C70640010000          	mov	word ptr DGROUP:_huboInt,0
                                   ;	
                                   ;	        return(TRUE) ;
                                   ;	
00000096  B80100                	mov	ax,1
00000099  5D                    	pop	bp
0000009A                        	ret	
                                   ;	
                                   ;	    }
                                   ;	
0000009B  EB02                  	jmp	short @2@6
0000009D                        @2@5:
                                   ;	
                                   ;	    else
                                   ;	        return(FALSE) ;
                                   ;	
0000009D  33C0                  	xor	ax,ax
0000009F                        @2@6:
                                   ;	
                                   ;	}
                                   ;	
0000009F  5D                    	pop	bp
000000A0                        	ret	
000000A1                        _leerEstadoRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
000000A1                        _openRaton	proc	far
                                   ;	
                                   ;	int far openRaton ( int dfs, modoAp_t modo )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    return(0) ;
                                   ;	
000000A1  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
000000A3                        	ret	
000000A4                        _openRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
000000A4                        _releaseRaton	proc	far
                                   ;	
                                   ;	int far releaseRaton ( int dfs )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    return(0) ;
                                   ;	
000000A4  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
000000A6                        	ret	
000000A7                        _releaseRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
000000A7                        _readRaton	proc	far
                                   ;	
                                   ;	int far readRaton ( int dfs, pointer_t dir, word_t nbytes )
                                   ;	
000000A7  C8040000              	enter	4,0
                                   ;	
                                   ;	{
                                   ;	    word_t nbARetornar ;
                                   ;	    pindx_t indProcesoActual ;
                                   ;	
                                   ;	    save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	
000000AB  1E                     	push	 ds 
                                   ;	
                                   ;	 	setraw_DS() ;           /* establece el DS correspondiente al programa */
                                   ;	
000000AC  2EA10300               	mov	 ax,word ptr cs:[3] 
000000B0  8CCA                   	mov	 dx,cs 
000000B2  03C2                   	add	 ax,dx 
000000B4  8ED8                   	mov	 ds,ax 
                                   ;	
                                   ;	
                                   ;	    indProcesoActual = *ptrIndProcesoActual ;
                                   ;	
000000B6  C41E0000              	les	bx,dword ptr DGROUP:_ptrIndProcesoActual
000000BA  268B07                	mov	ax,word ptr es:[bx]
000000BD  8946FC                	mov	word ptr [bp-4],ax
                                   ;	
                                   ;	    if (nbytes <= sizeof(estadoRaton_t))
                                   ;	
000000C0  837E0C22              	cmp	word ptr [bp+12],34
000000C4  7708                  	ja	short @5@8
                                   ;	
                                   ;	        nbARetornar = nbytes ;
                                   ;	
000000C6  8B460C                	mov	ax,word ptr [bp+12]
000000C9  8946FE                	mov	word ptr [bp-2],ax
000000CC  EB05                  	jmp	short @5@9
000000CE                        @5@8:
                                   ;	
                                   ;	    else
                                   ;	        nbARetornar = sizeof(estadoRaton_t) ;
                                   ;	
000000CE  C746FE2200            	mov	word ptr [bp-2],34
000000D3                        @5@9:
                                   ;	
                                   ;	    memcpy(dir, (pointer_t)&er, nbARetornar) ;
                                   ;	
000000D3  FF76FE                	push	word ptr [bp-2]
000000D6  1E                    	push	ds
000000D7  680901                	push	offset DGROUP:_er
000000DA  FF760A                	push	word ptr [bp+10]
000000DD  FF7608                	push	word ptr [bp+8]
000000E0  E80000                	call	near ptr _memcpy
000000E3  83C40A                	add	sp,10
                                   ;	
                                   ;	
                                   ;	    nbytesProceso[indProcesoActual] = nbARetornar ; /* nbytes esperando leer */
                                   ;	
000000E6  8B5EFC                	mov	bx,word ptr [bp-4]
000000E9  03DB                  	add	bx,bx
000000EB  8B46FE                	mov	ax,word ptr [bp-2]
000000EE  8987A400              	mov	word ptr DGROUP:_nbytesProceso[bx],ax
                                   ;	
                                   ;	    dirProceso[indProcesoActual] = dir ;
                                   ;	
000000F2  8B5EFC                	mov	bx,word ptr [bp-4]
000000F5  C1E302                	shl	bx,2
000000F8  8B560A                	mov	dx,word ptr [bp+10]
000000FB  8B4608                	mov	ax,word ptr [bp+8]
000000FE  8997C600              	mov	word ptr DGROUP:_dirProceso[bx+2],dx
00000102  8987C400              	mov	word ptr DGROUP:_dirProceso[bx],ax
                                   ;	
                                   ;	    encolarPC2c(indProcesoActual, &bloqueadosRaton) ;
                                   ;	
00000106  1E                    	push	ds
00000107  685600                	push	offset DGROUP:_bloqueadosRaton
0000010A  FF76FC                	push	word ptr [bp-4]
0000010D  E80000                	call	near ptr _encolarPC2c
00000110  83C406                	add	sp,6
                                   ;	
                                   ;	    bloquearProcesoActual(rec_raton) ;
                                   ;	
00000113  FF365400              	push	word ptr DGROUP:_rec_raton
00000117  FF1E5000              	call	dword ptr DGROUP:_bloquearProcesoActual
0000011B  59                    	pop	cx
                                   ;	
                                   ;	
                                   ;		restore_DS0() ;                               /* restaura el DS de SO1 */
                                   ;	
0000011C  1F                     	pop	 ds 
                                   ;	
                                   ;	    return(-1) ;
                                   ;	
0000011D  B8FFFF                	mov	ax,-1
                                   ;	
                                   ;	}
                                   ;	
00000120  C9                    	leave	
00000121                        	ret	
00000122                        _readRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000122                        _aio_readRaton	proc	far
                                   ;	
                                   ;	int far aio_readRaton ( int dfs, pointer_t dir, word_t nbytes )
                                   ;	
00000122  C8020000              	enter	2,0
                                   ;	
                                   ;	{
                                   ;	    word_t nbARetornar ;
                                   ;	
                                   ;	    save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	
00000126  1E                     	push	 ds 
                                   ;	
                                   ;	 	setraw_DS() ;           /* establece el DS correspondiente al programa */
                                   ;	
00000127  2EA10300               	mov	 ax,word ptr cs:[3] 
0000012B  8CCA                   	mov	 dx,cs 
0000012D  03C2                   	add	 ax,dx 
0000012F  8ED8                   	mov	 ds,ax 
                                   ;	
                                   ;	
                                   ;	    if (nbytes <= sizeof(estadoRaton_t))
                                   ;	
00000131  837E0C22              	cmp	word ptr [bp+12],34
00000135  7708                  	ja	short @6@8
                                   ;	
                                   ;	        nbARetornar = nbytes ;
                                   ;	
00000137  8B460C                	mov	ax,word ptr [bp+12]
0000013A  8946FE                	mov	word ptr [bp-2],ax
0000013D  EB05                  	jmp	short @6@9
0000013F                        @6@8:
                                   ;	
                                   ;	    else
                                   ;	        nbARetornar = sizeof(estadoRaton_t) ;
                                   ;	
0000013F  C746FE2200            	mov	word ptr [bp-2],34
00000144                        @6@9:
                                   ;	
                                   ;	    memcpy(dir, &er, nbARetornar) ;
                                   ;	
00000144  FF76FE                	push	word ptr [bp-2]
00000147  1E                    	push	ds
00000148  680901                	push	offset DGROUP:_er
0000014B  FF760A                	push	word ptr [bp+10]
0000014E  FF7608                	push	word ptr [bp+8]
00000151  E80000                	call	near ptr _memcpy
00000154  83C40A                	add	sp,10
                                   ;	
                                   ;	
                                   ;		restore_DS0() ;                               /* restaura el DS de SO1 */
                                   ;	
00000157  1F                     	pop	 ds 
                                   ;	
                                   ;	    return(nbARetornar) ;
                                   ;	
00000158  8B46FE                	mov	ax,word ptr [bp-2]
                                   ;	
                                   ;	}
                                   ;	
0000015B  C9                    	leave	
0000015C                        	ret	
0000015D                        _aio_readRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000015D                        _writeRaton	proc	far
                                   ;	
                                   ;	int far writeRaton ( int dfs, pointer_t dir, word_t nbytes )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    return(0) ;
                                   ;	
0000015D  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
0000015F                        	ret	
00000160                        _writeRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000160                        _aio_writeRaton	proc	far
                                   ;	
                                   ;	int far aio_writeRaton ( int dfs, pointer_t dir, word_t nbytes )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    return(0) ;
                                   ;	
00000160  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
00000162                        	ret	
00000163                        _aio_writeRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000163                        _lseekRaton	proc	far
                                   ;	
                                   ;	long int far lseekRaton ( int dfs, long int pos, word_t whence )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    return((long int)-1) ;
                                   ;	
00000163  BAFFFF                	mov	dx,-1
00000166  B8FFFF                	mov	ax,-1
                                   ;	
                                   ;	}
                                   ;	
00000169                        	ret	
0000016A                        _lseekRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000016A                        _fcntlRaton	proc	far
                                   ;	
                                   ;	int far fcntlRaton ( int dfs, word_t cmd, word_t arg )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    return(0) ;
                                   ;	
0000016A  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
0000016C                        	ret	
0000016D                        _fcntlRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000016D                        _ioctlRaton	proc	far
                                   ;	
                                   ;	int far ioctlRaton ( int dfs, word_t request, word_t arg )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    return(0) ;
                                   ;	
0000016D  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
0000016F                        	ret	
00000170                        _ioctlRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000170                        _eliminarRaton	proc	far
                                   ;	
                                   ;	int far eliminarRaton ( pindx_t pindx )
                                   ;	
00000170  55                    	push	bp
00000171  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	{
                                   ;	    save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	
00000173  1E                     	push	 ds 
                                   ;	
                                   ;	 	setraw_DS() ;           /* establece el DS correspondiente al programa */
                                   ;	
00000174  2EA10300               	mov	 ax,word ptr cs:[3] 
00000178  8CCA                   	mov	 dx,cs 
0000017A  03C2                   	add	 ax,dx 
0000017C  8ED8                   	mov	 ds,ax 
                                   ;	
                                   ;		
                                   ;	    if (estaPC2c(pindx, &bloqueadosRaton))
                                   ;	
0000017E  8B4606                	mov	ax,word ptr [bp+6]
00000181  C1E002                	shl	ax,2
00000184  C41E5C00              	les	bx,dword ptr DGROUP:_bloqueadosRaton+6
00000188  03D8                  	add	bx,ax
0000018A  26833FFF              	cmp	word ptr es:[bx],-1
0000018E  740D                  	je	short @12@8
                                   ;	
                                   ;	        eliminarPC2c(pindx, &bloqueadosRaton) ;
                                   ;	
00000190  1E                    	push	ds
00000191  685600                	push	offset DGROUP:_bloqueadosRaton
00000194  FF7606                	push	word ptr [bp+6]
00000197  E80000                	call	near ptr _eliminarPC2c
0000019A  83C406                	add	sp,6
0000019D                        @12@8:
                                   ;	
                                   ;	
                                   ;		restore_DS0() ;                               /* restaura el DS de SO1 */
                                   ;	
0000019D  1F                     	pop	 ds 
                                   ;	
                                   ;	    return(0) ;
                                   ;	
0000019E  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
000001A0  5D                    	pop	bp
000001A1                        	ret	
000001A2                        _eliminarRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
000001A2                        _isr_raton	proc	far
                                   ;	
                                   ;	void far isr_raton ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	
000001A2  1E                     	push	 ds 
                                   ;	
                                   ;	 	set_DS() ;              /* establece el DS correspondiente al programa */
                                   ;	
000001A3  50                     	push	 ax 
000001A4  52                     	push	 dx 
000001A5  2EA10300               	mov	 ax,word ptr cs:[3] 
000001A9  8CCA                   	mov	 dx,cs 
000001AB  03C2                   	add	 ax,dx 
000001AD  8ED8                   	mov	 ds,ax 
000001AF  5A                     	pop	 dx 
000001B0  58                     	pop	 ax 
                                   ;	
                                   ;	
                                   ;	//                                    /*  plot('m', 0, contadorTimer0()) ; */
                                   ;	    tratarRaton() ;
                                   ;	
000001B1  E8B900                	call	near ptr _tratarRaton
                                   ;	
                                   ;	//                                    /*  plot('e', 0, contadorTimer0()) ; */
                                   ;	    eoi_pic2() ;
                                   ;	
000001B4  B020                   	mov	 al,020H 
000001B6  E6A0                   	out	 000A0H,al 
000001B8  B020                   	mov	 al,020H 
000001BA  E620                   	out	 00020H,al 
                                   ;	
                                   ;	
                                   ;		restore_DS0() ;                               /* restaura el DS de SO1 */
                                   ;	
000001BC  1F                     	pop	 ds 
                                   ;	
                                   ;	}
                                   ;	
000001BD                        	ret	
000001BE                        _isr_raton	endp
                                	assume	cs:_TEXT,ds:DGROUP
000001BE                        _isr_raton_dosbox	proc	far
                                   ;	
                                   ;	void far isr_raton_dosbox ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	
000001BE  1E                     	push	 ds 
                                   ;	
                                   ;	 	set_DS() ;              /* establece el DS correspondiente al programa */
                                   ;	
000001BF  50                     	push	 ax 
000001C0  52                     	push	 dx 
000001C1  2EA10300               	mov	 ax,word ptr cs:[3] 
000001C5  8CCA                   	mov	 dx,cs 
000001C7  03C2                   	add	 ax,dx 
000001C9  8ED8                   	mov	 ds,ax 
000001CB  5A                     	pop	 dx 
000001CC  58                     	pop	 ax 
                                   ;	
                                   ;	
                                   ;	    ptrVIOrg[nVIntRaton]() ;    /* llamamos a la antigua rti (pushf + int) */
                                   ;	
000001CD  C41E4000              	les	bx,dword ptr DGROUP:_ptrVIOrg
000001D1  9C                    	pushf	
000001D2  26FF9FD001            	call	dword ptr es:[bx+464]
                                   ;	
                                   ;	//                                    /*  plot('m', 0, contadorTimer0()) ; */
                                   ;	    procesarRaton((word_t)er.B0, er.X, er.Y) ;
                                   ;	
000001D7  FF361501              	push	word ptr DGROUP:_er+12
000001DB  FF361301              	push	word ptr DGROUP:_er+10
000001DF  A00A01                	mov	al,byte ptr DGROUP:_er+1
000001E2  B400                  	mov	ah,0
000001E4  50                    	push	ax
000001E5  E89201                	call	near ptr _procesarRaton
000001E8  83C406                	add	sp,6
                                   ;	
                                   ;	//                                    /*  plot('e', 0, contadorTimer0()) ; */
                                   ;	//  eoi_pic2() ; 
                                   ;	
                                   ;		restore_DS0() ;                               /* restaura el DS de SO1 */
                                   ;	
000001EB  1F                     	pop	 ds 
                                   ;	
                                   ;	}
                                   ;	
000001EC                        	ret	
000001ED                        _isr_raton_dosbox	endp
000001ED                        _TEXT	ends
00000144                        _DATA	segment word public 'DATA'
00000144                        _rH_CS	label	word
00000144  00                    	db	0
00000145  00                    	db	0
00000146                        _rH_IP	label	word
00000146  00                    	db	0
00000147  00                    	db	0
00000148                        _rH_AX	label	word
00000148  00                    	db	0
00000149  00                    	db	0
0000014A                        _rH_BX	label	word
0000014A  00                    	db	0
0000014B  00                    	db	0
0000014C                        _rH_CX	label	word
0000014C  00                    	db	0
0000014D  00                    	db	0
0000014E                        _rH_DX	label	word
0000014E  00                    	db	0
0000014F  00                    	db	0
00000150                        _rH_SI	label	word
00000150  00                    	db	0
00000151  00                    	db	0
00000152                        _rH_DI	label	word
00000152  00                    	db	0
00000153  00                    	db	0
00000154                        _DATA	ends
000001ED                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
000001ED                        _isr_raton_BIOS	proc	far
                                   ;	
                                   ;	void far isr_raton_BIOS ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	
000001ED  1E                     	push	 ds 
                                   ;	
                                   ;	 	set_DS() ;              /* establece el DS correspondiente al programa */
                                   ;	
000001EE  50                     	push	 ax 
000001EF  52                     	push	 dx 
000001F0  2EA10300               	mov	 ax,word ptr cs:[3] 
000001F4  8CCA                   	mov	 dx,cs 
000001F6  03C2                   	add	 ax,dx 
000001F8  8ED8                   	mov	 ds,ax 
000001FA  5A                     	pop	 dx 
000001FB  58                     	pop	 ax 
                                   ;	
                                   ;	
                                   ;	//                                    /*  plot('m', 0, contadorTimer0()) ; */
                                   ;	    procesarRaton(rH_BX, rH_CX, rH_DX)  ;
                                   ;	
000001FC  FF364E01              	push	word ptr DGROUP:_rH_DX
00000200  FF364C01              	push	word ptr DGROUP:_rH_CX
00000204  FF364A01              	push	word ptr DGROUP:_rH_BX
00000208  E86F01                	call	near ptr _procesarRaton
0000020B  83C406                	add	sp,6
                                   ;	
                                   ;	//                                    /*  plot('e', 0, contadorTimer0()) ; */
                                   ;	//  eoi_pic2() ;
                                   ;	
                                   ;		restore_DS0() ;                               /* restaura el DS de SO1 */
                                   ;	
0000020E  1F                     	pop	 ds 
                                   ;	
                                   ;	}
                                   ;	
0000020F                        	ret	
00000210                        _isr_raton_BIOS	endp
00000210                        _TEXT	ends
00000154                        _DATA	segment word public 'DATA'
00000154                        _rti_nVIntRaton	label	dword
00000154  00                    	db	0
00000155  00                    	db	0
00000156  00                    	db	0
00000157  00                    	db	0
00000158                        _segment_rti_nVIntRaton	label	word
00000158  00                    	db	0
00000159  00                    	db	0
0000015A                        _offset_rti_nVIntRaton	label	word
0000015A  00                    	db	0
0000015B  00                    	db	0
0000015C                        _ptrWordAux	label	dword
0000015C  00                    	db	0
0000015D  00                    	db	0
0000015E  00                    	db	0
0000015F  00                    	db	0
00000160                        _DATA	ends
00000210                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
00000210                        _rti_raton_BIOS	proc	far
                                   ;	
                                   ;	void far rti_raton_BIOS ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    asm {		
                                   ;			sub sp,10 ;                             /* Flags, CS, IP (Proceso) */
                                   ;	
00000210  83EC0A                	sub	 sp,10 
                                   ;	
                                   ;	//                                               /* segment_rti_nVIntRaton */
                                   ;	//                                                /* offset_rti_nVIntRaton */
                                   ;	    }
                                   ;	    save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	
00000213  1E                     	push	 ds 
                                   ;	
                                   ;	 	set_DS() ;              /* establece el DS correspondiente al programa */
                                   ;	
00000214  50                     	push	 ax 
00000215  52                     	push	 dx 
00000216  2EA10300               	mov	 ax,word ptr cs:[3] 
0000021A  8CCA                   	mov	 dx,cs 
0000021C  03C2                   	add	 ax,dx 
0000021E  8ED8                   	mov	 ds,ax 
00000220  5A                     	pop	 dx 
00000221  58                     	pop	 ax 
                                   ;	
                                   ;	
                                   ;	    asm {				  
                                   ;	        push ax ;
                                   ;	
00000222  50                    	push	 ax 
                                   ;	
                                   ;	        push bp ;
                                   ;	
00000223  55                    	push	 bp 
                                   ;	
                                   ;	
                                   ;	        mov bp,sp ;
                                   ;	
00000224  8BEC                  	mov	 bp,sp 
                                   ;	
                                   ;	        mov ax,rH_CS ;                                     /* CS (Proceso) */  
                                   ;	
00000226  A14401                	mov	 ax,DGROUP:_rH_CS 
                                   ;	
                                   ;	        mov ss:[bp+12],ax ;   
                                   ;	
00000229  89460C                	mov	 ss:[bp+12],ax 
                                   ;	
                                   ;	        mov ax,rH_IP ;
                                   ;	
0000022C  A14601                	mov	 ax,DGROUP:_rH_IP 
                                   ;	
                                   ;	        mov ss:[bp+10],ax ;                                /* IP (Proceso) */
                                   ;	
0000022F  89460A                	mov	 ss:[bp+10],ax 
                                   ;	
                                   ;	        mov ax,segment_rti_nVIntRaton ;
                                   ;	
00000232  A15801                	mov	 ax,DGROUP:_segment_rti_nVIntRaton 
                                   ;	
                                   ;	        mov ss:[bp+8],ax ;                       /* segment_rti_nVIntRaton */      
                                   ;	
00000235  894608                	mov	 ss:[bp+8],ax 
                                   ;	
                                   ;	        mov ax,offset_rti_nVIntRaton ;
                                   ;	
00000238  A15A01                	mov	 ax,DGROUP:_offset_rti_nVIntRaton 
                                   ;	
                                   ;	        mov ss:[bp+6],ax ;                        /* offset_rti_nVIntRaton */
                                   ;	
0000023B  894606                	mov	 ss:[bp+6],ax 
                                   ;	
                                   ;		}
                                   ;	/*
                                   ;	        printStrBIOS("\n isr_raton_BIOS") ;
                                   ;	        ptrWordAux = (word_t far  *)MK_FP(_SS,_SP) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[0], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[1], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[2], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[3], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[4], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[5], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[6], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[7], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	        printHexBIOS(ptrWordAux[8], 4) ;
                                   ;	        printStrBIOS("\n ") ;
                                   ;	*/
                                   ;	    asm {
                                   ;	        pop bp ;
                                   ;	
0000023E  5D                    	pop	 bp 
                                   ;	
                                   ;	        pop ax ;
                                   ;	
0000023F  58                    	pop	 ax 
                                   ;	
                                   ;	        /* retorno lejano a rti_nVIntRaton */
                                   ;		}
                                   ;		restore_DS0() ;                               /* restaura el DS de SO1 */	
                                   ;	
00000240  1F                     	pop	 ds 
                                   ;	
                                   ;	}
                                   ;	
00000241                        	ret	
00000242                        _rti_raton_BIOS	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000242                        _ratonHandler	proc	far
                                   ;	
                                   ;	void far ratonHandler ( void )           /* ver techelp int 33h AH = 000Ch */
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    /* Se llama a esta funcion tras la interrupcion y mediante un CALL FAR */
                                   ;	    /* Por ese motivo la pila contiene lo siguiente:                       */
                                   ;		/*                                                                     */
                                   ;		/*     Flags, CS, IP del proceso y direccion de retorno (lejana)       */
                                   ;		/*                                                                     */
                                   ;		/* Es innecesario establecer DS (ver techelp int 33h 000Ch)            */
                                   ;		
                                   ;	
                                   ;	//  save_DS0() ;                            /* guarda el DS anterior (SO1) */
                                   ;	// 	set_DS() ;              /* establece el DS correspondiente al programa */
                                   ;		
                                   ;	    asm {
                                   ;			mov rH_AX,ax ;        /* mascara de eventos ocurridos, ver techelp */
                                   ;	
00000242  A34801                	mov	 DGROUP:_rH_AX,ax 
                                   ;	
                                   ;	        mov rH_BX,bx ;                                /* botones: 00000MRL */
                                   ;	
00000245  891E4A01              	mov	 DGROUP:_rH_BX,bx 
                                   ;	
                                   ;	        mov rH_CX,cx ;                                                /* X */
                                   ;	
00000249  890E4C01              	mov	 DGROUP:_rH_CX,cx 
                                   ;	
                                   ;	        mov rH_DX,dx ;                                                /* Y */
                                   ;	
0000024D  89164E01              	mov	 DGROUP:_rH_DX,dx 
                                   ;	
                                   ;	//      mov rH_SI,si ;                                             /* incX */
                                   ;	//      mov rH_DI,di ;                                             /* incY */
                                   ;	
                                   ;	    /* Con lo siguente modificamos la trama de la pila de manera que la    */
                                   ;	    /* interrupcion en vez de retornar al CS:IP del proceso, retorne a la  */
                                   ;	    /* a la rutina rti_raton_BIOS. El CS:IP del proceso quedan guardados   */
                                   ;	    /* en las variables rH_CS:rH_IP con el fin de poder retornar en un     */
                                   ;	    /* momento posterior al proceso.                                       */     
                                   ;	
                                   ;	        push ax ;
                                   ;	
00000251  50                    	push	 ax 
                                   ;	
                                   ;	        push bp ;
                                   ;	
00000252  55                    	push	 bp 
                                   ;	
                                   ;	        mov bp,sp ;
                                   ;	
00000253  8BEC                  	mov	 bp,sp 
                                   ;	
                                   ;	        mov ax,ss:[bp+12] ;                              /* CS del proceso */
                                   ;	
00000255  8B460C                	mov	 ax,ss:[bp+12] 
                                   ;	
                                   ;	        mov rH_CS,ax ;                                   
                                   ;	
00000258  A34401                	mov	 DGROUP:_rH_CS,ax 
                                   ;	
                                   ;	        mov ax,ss:[bp+10] ;                              /* IP del proceso */
                                   ;	
0000025B  8B460A                	mov	 ax,ss:[bp+10] 
                                   ;	
                                   ;	        mov rH_IP,ax ;       
                                   ;	
0000025E  A34601                	mov	 DGROUP:_rH_IP,ax 
                                   ;	
                                   ;	        mov ss:[bp+12],cs ;                                          /* CS */
                                   ;	
00000261  8C4E0C                	mov	 ss:[bp+12],cs 
                                   ;	
                                   ;	        mov ax,OFFSET rti_raton_BIOS ;                   /* rti_raton_BIOS */
                                   ;	
00000264  B81002                	mov	 ax,OFFSET _rti_raton_BIOS 
                                   ;	
                                   ;	        mov ss:[bp+10],ax ;
                                   ;	
00000267  89460A                	mov	 ss:[bp+10],ax 
                                   ;	
                                   ;	        pop bp ;
                                   ;	
0000026A  5D                    	pop	 bp 
                                   ;	
                                   ;	        pop ax ;
                                   ;	
0000026B  58                    	pop	 ax 
                                   ;	
                                   ;	    }
                                   ;	//	restore_DS0() ;                               /* restaura el DS de SO1 */	
                                   ;	}                            /* de el a isr_raton_bios y de ahi al proceso */
                                   ;	
0000026C                        	ret	
0000026D                        _ratonHandler	endp
0000026D                        _TEXT	ends
00000160                        _DATA	segment word public 'DATA'
00000160                        $aoobdaia	label	byte
00000160  00                    	db	0
00000161                        $ibpbdaia	label	byte
00000161  00                    	db	0
00000162                        $afpbdaia	label	word
00000162  00                    	db	0
00000163  00                    	db	0
00000164                        $iipbdaia	label	word
00000164  00                    	db	0
00000165  00                    	db	0
00000166                        _DATA	ends
0000026D                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
0000026D                        _tratarRaton	proc	near
                                   ;	
                                   ;	void tratarRaton ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    static byte_t byteEstado = 0 ;                                 /* DATA */
                                   ;	    static byte_t byteDato = 0 ;                                   /* DATA */
                                   ;	    static int incX = 0, incY = 0 ;                                /* DATA */
                                   ;	
                                   ;	    asm in al,64h ;                                      /* TECLADO_ESTADO */
                                   ;	
0000026D  E464                   	in	 al,64h 
                                   ;	
                                   ;	    asm mov byteEstado,al
                                   ;	
0000026F  A26001                 	mov	 $aoobdaia,al
                                   ;	
                                   ;	    if ((byteEstado & 0x21) == 0x21)      /* hay byte procedente del raton */
                                   ;	
00000272  A06001                	mov	al,byte ptr DGROUP:$aoobdaia
00000275  B400                  	mov	ah,0
00000277  83E021                	and	ax,33
0000027A  83F821                	cmp	ax,33
0000027D  7403                  	je	@@0
0000027F  E9F700                	jmp	@18@28
00000282                        @@0:
                                   ;	
                                   ;	    {
                                   ;	        er.S0 = byteEstado ;
                                   ;	
00000282  A06001                	mov	al,byte ptr DGROUP:$aoobdaia
00000285  A20901                	mov	byte ptr DGROUP:_er,al
                                   ;	
                                   ;	        asm in al,60h ;                                    /* TECLADO_DATO */
                                   ;	
00000288  E460                   	in	 al,60h 
                                   ;	
                                   ;	        asm mov byteDato,al ;
                                   ;	
0000028A  A26101                 	mov	 $ibpbdaia,al 
                                   ;	
                                   ;	
                                   ;	        if ((inB != 0) || (((byteDato^0x08) & 0xC8) == 0))
                                   ;	
0000028D  833E040100            	cmp	word ptr DGROUP:_inB,0
00000292  750C                  	jne	short @18@8
00000294  A06101                	mov	al,byte ptr DGROUP:$ibpbdaia
00000297  3408                  	xor	al,8
00000299  A8C8                  	test	al,200
0000029B  7403                  	je	@@1
0000029D  E9D900                	jmp	@18@28
000002A0                        @@1:
000002A0                        @18@8:
                                   ;	
                                   ;	        {
                                   ;	            B[inB] = byteDato ;
                                   ;	
000002A0  8B1E0401              	mov	bx,word ptr DGROUP:_inB
000002A4  A06101                	mov	al,byte ptr DGROUP:$ibpbdaia
000002A7  88870601              	mov	byte ptr DGROUP:_B[bx],al
                                   ;	
                                   ;	            inB = (inB + 1) % 3 ;
                                   ;	
000002AB  A10401                	mov	ax,word ptr DGROUP:_inB
000002AE  40                    	inc	ax
000002AF  BB0300                	mov	bx,3
000002B2  99                    	cwd	
000002B3  F7FB                  	idiv	bx
000002B5  89160401              	mov	word ptr DGROUP:_inB,dx
                                   ;	
                                   ;	
                                   ;	            if (inB == 0)
                                   ;	
000002B9  833E040100            	cmp	word ptr DGROUP:_inB,0
000002BE  7403                  	je	@@2
000002C0  E9B600                	jmp	@18@28
000002C3                        @@2:
                                   ;	
                                   ;	            {
                                   ;	
                                   ;	                er.B0 = B[0] ;
                                   ;	
000002C3  A00601                	mov	al,byte ptr DGROUP:_B
000002C6  A20A01                	mov	byte ptr DGROUP:_er+1,al
                                   ;	
                                   ;	                er.B1 = B[1] ;
                                   ;	
000002C9  A00701                	mov	al,byte ptr DGROUP:_B+1
000002CC  A20B01                	mov	byte ptr DGROUP:_er+2,al
                                   ;	
                                   ;	                if (er.B0 & 0x10)
                                   ;	
000002CF  F6060A0110            	test	byte ptr DGROUP:_er+1,16
000002D4  7410                  	je	short @18@14
                                   ;	
                                   ;	                {
                                   ;	                    asm mov al, byte ptr er.B1 ;
                                   ;	
000002D6  A00B01                 	mov	 al, byte ptr DGROUP:_er+2 
                                   ;	
                                   ;	                    asm mov ah,0ffh ;
                                   ;	
000002D9  B4FF                   	mov	 ah,0ffh 
                                   ;	
                                   ;	                    asm mov incX,ax ;
                                   ;	
000002DB  A36201                 	mov	 $afpbdaia,ax 
                                   ;	
                                   ;	                    er.incX = incX ;
                                   ;	
000002DE  A16201                	mov	ax,word ptr DGROUP:$afpbdaia
000002E1  A30F01                	mov	word ptr DGROUP:_er+6,ax
                                   ;	
                                   ;	                }
                                   ;	
000002E4  EB08                  	jmp	short @18@15
000002E6                        @18@14:
                                   ;	
                                   ;	                else er.incX = er.B1 ;
                                   ;	
000002E6  A00B01                	mov	al,byte ptr DGROUP:_er+2
000002E9  B400                  	mov	ah,0
000002EB  A30F01                	mov	word ptr DGROUP:_er+6,ax
000002EE                        @18@15:
                                   ;	
                                   ;	                XAux = er.X + er.incX ;
                                   ;	
000002EE  A11301                	mov	ax,word ptr DGROUP:_er+10
000002F1  03060F01              	add	ax,word ptr DGROUP:_er+6
000002F5  A32C01                	mov	word ptr DGROUP:_XAux,ax
                                   ;	
                                   ;	                if ((0 <= XAux) && (XAux < maxX))            /* 8*80 = 640 */
                                   ;	
000002F8  833E2C0100            	cmp	word ptr DGROUP:_XAux,0
000002FD  7C0E                  	jl	short @18@18
000002FF  813E2C018002          	cmp	word ptr DGROUP:_XAux,640
00000305  7D06                  	jge	short @18@18
                                   ;	
                                   ;	                    er.X = XAux ;
                                   ;	
00000307  A12C01                	mov	ax,word ptr DGROUP:_XAux
0000030A  A31301                	mov	word ptr DGROUP:_er+10,ax
0000030D                        @18@18:
                                   ;	
                                   ;	
                                   ;	                er.B2 = B[2] ;
                                   ;	
0000030D  A00801                	mov	al,byte ptr DGROUP:_B+2
00000310  A20C01                	mov	byte ptr DGROUP:_er+3,al
                                   ;	
                                   ;	                if (er.B0 & 0x20)
                                   ;	
00000313  F6060A0120            	test	byte ptr DGROUP:_er+1,32
00000318  7410                  	je	short @18@23
                                   ;	
                                   ;	                {
                                   ;	                    asm mov al, byte ptr er.B2 ;
                                   ;	
0000031A  A00C01                 	mov	 al, byte ptr DGROUP:_er+3 
                                   ;	
                                   ;	                    asm mov ah,0ffh ;
                                   ;	
0000031D  B4FF                   	mov	 ah,0ffh 
                                   ;	
                                   ;	                    asm mov incY,ax ;
                                   ;	
0000031F  A36401                 	mov	 $iipbdaia,ax 
                                   ;	
                                   ;	                    er.incY = incY ;
                                   ;	
00000322  A16401                	mov	ax,word ptr DGROUP:$iipbdaia
00000325  A31101                	mov	word ptr DGROUP:_er+8,ax
                                   ;	
                                   ;	                }
                                   ;	
00000328  EB08                  	jmp	short @18@24
0000032A                        @18@23:
                                   ;	
                                   ;	                else er.incY = er.B2 ;
                                   ;	
0000032A  A00C01                	mov	al,byte ptr DGROUP:_er+3
0000032D  B400                  	mov	ah,0
0000032F  A31101                	mov	word ptr DGROUP:_er+8,ax
00000332                        @18@24:
                                   ;	
                                   ;	                er.incY = -er.incY ;                                /* ojo */
                                   ;	
00000332  A11101                	mov	ax,word ptr DGROUP:_er+8
00000335  F7D8                  	neg	ax
00000337  A31101                	mov	word ptr DGROUP:_er+8,ax
                                   ;	
                                   ;	                YAux = er.Y + er.incY ;
                                   ;	
0000033A  A11501                	mov	ax,word ptr DGROUP:_er+12
0000033D  03061101              	add	ax,word ptr DGROUP:_er+8
00000341  A32E01                	mov	word ptr DGROUP:_YAux,ax
                                   ;	
                                   ;	                if ((0 <= YAux) && (YAux < maxYAct))         /* 8*25 = 200 */
                                   ;	
00000344  833E2E0100            	cmp	word ptr DGROUP:_YAux,0
00000349  7C1A                  	jl	short @18@27
0000034B  33C0                  	xor	ax,ax
0000034D  8EC0                  	mov	es,ax
0000034F  26A08404              	mov	al,byte ptr es:[1156]
00000353  B400                  	mov	ah,0
00000355  40                    	inc	ax
00000356  C1E003                	shl	ax,3
00000359  3B062E01              	cmp	ax,word ptr DGROUP:_YAux
0000035D  7E06                  	jle	short @18@27
                                   ;	
                                   ;	                    er.Y = YAux ;
                                   ;	
0000035F  A12E01                	mov	ax,word ptr DGROUP:_YAux
00000362  A31501                	mov	word ptr DGROUP:_er+12,ax
00000365                        @18@27:
                                   ;	
                                   ;	
                                   ;	                procesarRaton((word_t)er.B0, er.X, er.Y) ;
                                   ;	
00000365  FF361501              	push	word ptr DGROUP:_er+12
00000369  FF361301              	push	word ptr DGROUP:_er+10
0000036D  A00A01                	mov	al,byte ptr DGROUP:_er+1
00000370  B400                  	mov	ah,0
00000372  50                    	push	ax
00000373  E80400                	call	near ptr _procesarRaton
00000376  83C406                	add	sp,6
00000379                        @18@28:
                                   ;	
                                   ;	            }
                                   ;	        }
                                   ;	    }
                                   ;	}
                                   ;	
00000379                        	ret	
0000037A                        _tratarRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000037A                        _procesarRaton	proc	near
                                   ;	
                                   ;	void procesarRaton ( word_t parW0, int parX, int parY )
                                   ;	
0000037A  55                    	push	bp
0000037B  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	{
                                   ;	
                                   ;	//  static int posWF ;
                                   ;	//  static int posWC ;
                                   ;	//  static int FReal ;
                                   ;	//  static int CReal ;
                                   ;	
                                   ;	    er.W0 = parW0 ;
                                   ;	
0000037D  8B4604                	mov	ax,word ptr [bp+4]
00000380  A30D01                	mov	word ptr DGROUP:_er+4,ax
                                   ;	
                                   ;	    er.X = parX ;
                                   ;	
00000383  8B4606                	mov	ax,word ptr [bp+6]
00000386  A31301                	mov	word ptr DGROUP:_er+10,ax
                                   ;	
                                   ;	    er.Y = parY ;
                                   ;	
00000389  8B4608                	mov	ax,word ptr [bp+8]
0000038C  A31501                	mov	word ptr DGROUP:_er+12,ax
                                   ;	
                                   ;	
                                   ;	    er.F = er.Y >> 3 ;                                          /* F = Y/8 */
                                   ;	
0000038F  A11501                	mov	ax,word ptr DGROUP:_er+12
00000392  C1F803                	sar	ax,3
00000395  A31701                	mov	word ptr DGROUP:_er+14,ax
                                   ;	
                                   ;	    er.C = er.X >> 3 ;                                          /* C = X/8 */
                                   ;	
00000398  A11301                	mov	ax,word ptr DGROUP:_er+10
0000039B  C1F803                	sar	ax,3
0000039E  A31901                	mov	word ptr DGROUP:_er+16,ax
                                   ;	
                                   ;	
                                   ;	    er.B0 = (byte_t)(er.W0 & 0x00FF) ;
                                   ;	
000003A1  A00D01                	mov	al,byte ptr DGROUP:_er+4
000003A4  24FF                  	and	al,255
000003A6  A20A01                	mov	byte ptr DGROUP:_er+1,al
                                   ;	
                                   ;	
                                   ;	    huboInt = TRUE ;             /* obtenidos nuevos valores para el raton */
                                   ;	
000003A9  C70640010100          	mov	word ptr DGROUP:_huboInt,1
                                   ;	
                                   ;	
                                   ;	    er.botonIzAnt = er.botonIz ;
                                   ;	
000003AF  A11B01                	mov	ax,word ptr DGROUP:_er+18
000003B2  A32101                	mov	word ptr DGROUP:_er+24,ax
                                   ;	
                                   ;	    er.botonDeAnt = er.botonDe ;
                                   ;	
000003B5  A11D01                	mov	ax,word ptr DGROUP:_er+20
000003B8  A32301                	mov	word ptr DGROUP:_er+26,ax
                                   ;	
                                   ;	    er.botonMeAnt = er.botonMe ;
                                   ;	
000003BB  A11F01                	mov	ax,word ptr DGROUP:_er+22
000003BE  A32501                	mov	word ptr DGROUP:_er+28,ax
                                   ;	
                                   ;	
                                   ;	    er.botonIz = (er.W0 & 0x0001) ;
                                   ;	
000003C1  A10D01                	mov	ax,word ptr DGROUP:_er+4
000003C4  83E001                	and	ax,1
000003C7  A31B01                	mov	word ptr DGROUP:_er+18,ax
                                   ;	
                                   ;	    er.botonDe = ((er.W0 & 0x0002) >> 1) ;
                                   ;	
000003CA  A10D01                	mov	ax,word ptr DGROUP:_er+4
000003CD  83E002                	and	ax,2
000003D0  D1E8                  	shr	ax,1
000003D2  A31D01                	mov	word ptr DGROUP:_er+20,ax
                                   ;	
                                   ;	    er.botonMe = ((er.W0 & 0x0004) >> 2) ;
                                   ;	
000003D5  A10D01                	mov	ax,word ptr DGROUP:_er+4
000003D8  83E004                	and	ax,4
000003DB  C1E802                	shr	ax,2
000003DE  A31F01                	mov	word ptr DGROUP:_er+22,ax
                                   ;	
                                   ;	
                                   ;	    procesarColaBloqueadosRaton() ;
                                   ;	
000003E1  E83100                	call	near ptr _procesarColaBloqueadosRaton
                                   ;	
                                   ;	
                                   ;	    if (cursorRatonActivo)
                                   ;	
000003E4  833E360100            	cmp	word ptr DGROUP:_cursorRatonActivo,0
000003E9  7428                  	je	short @19@9
                                   ;	
                                   ;	    {
                                   ;	        if (er.botonIz)                      /* boton izquierdo presionado */
                                   ;	
000003EB  833E1B0100            	cmp	word ptr DGROUP:_er+18,0
000003F0  7402                  	je	short @19@4
                                   ;	
                                   ;	        {
                                   ;	#if (FALSE)
                                   ;	            if (moviendo || redimensionando)
                                   ;	            {
                                   ;	                if (moviendo)                                  /* moviendo */
                                   ;	                {
                                   ;	                    posWF = win->esqSupIzF ;
                                   ;	                    posWC = win->esqSupIzC ;
                                   ;	                    moverWin(win, er.F-FAntCursor, er.C-CAntCursor,
                                   ;	                             er.F-FAntCursor, er.C-CAntCursor) ;
                                   ;	                    FReal = FAntCursor + (win->esqSupIzF - posWF) ; /* F Real */
                                   ;	                    CReal = CAntCursor + (win->esqSupIzC - posWC) ; /* C Real */
                                   ;	                }
                                   ;	                else                                    /* redimensionando */
                                   ;	                {
                                   ;	                    posWF = win->esqInfDeF ;
                                   ;	                    posWC = win->esqInfDeC ;
                                   ;	                    moverWin(win, 0, 0, er.F-FAntCursor, er.C-CAntCursor) ;
                                   ;	                    FReal = FAntCursor + (win->esqInfDeF - posWF) ; /* F Real */
                                   ;	                    CReal = CAntCursor + (win->esqInfDeC - posWC) ; /* C Real */
                                   ;	                }
                                   ;	                if ((FReal != er.F) || (CReal != er.C))
                                   ;	                {
                                   ;	                    er.Y = (FReal << 3) + 3 ;                     /* ajuste Y */
                                   ;	                    er.X = (CReal << 3) + 3 ;                     /* ajuste X */
                                   ;	                    if (tipoRaton == msdos)
                                   ;	                        situarCursorRatonBIOS(er.X, er.Y) ;
                                   ;	                }
                                   ;	                er.F = FReal ;
                                   ;	                er.C = CReal ;
                                   ;	                actualizarCursor() ;
                                   ;	            }
                                   ;	            else if ((nwin = winVisible[er.F][er.C]) != 0)
                                   ;	            {
                                   ;	                if (!er.botonIzAnt)    /* primera pulsacion del boton izdo */
                                   ;	                {
                                   ;	                    win = winNum[nwin] ;
                                   ;	                    pindx = win->pindx ;
                                   ;	
                                   ;	                    if (er.F == win->esqSupIzF-1)        /* marco superior */
                                   ;	                    {
                                   ;	                        if (er.C == win->esqInfDeC-1) botonCerrarVentana() ;       /* [X] */
                                   ;	                        else if (er.C == win->esqInfDeC-4) maxMinWin(win, FALSE) ; /* [f] */
                                   ;	                        else if ((er.F == win->esqSupIzF-1) &&
                                   ;	                                 (win->esqSupIzC <= er.C) &&
                                   ;	                                 (er.C <= win->esqSupIzC+2+2*(win->pindx!=0)))
                                   ;	                            maxMinWin(win, TRUE) ;                                 /* max */
                                   ;	                        else
                                   ;	                            tratarClickMarco() ;
                                   ;	                    }
                                   ;	                    else if ((er.F == win->esqInfDeF+1) &&
                                   ;	                             (er.C == win->esqInfDeC+1))  /* redimensionar */
                                   ;	                    {
                                   ;	                        focalizarWin(win) ;
                                   ;	                        redimensionando = TRUE ;
                                   ;	                        actualizarCursor() ;
                                   ;	                    }
                                   ;	                    else if ((er.F == win->esqInfDeF+1) ||
                                   ;	                             (er.C == win->esqSupIzC-1) ||
                                   ;	                             (er.C == win->esqInfDeC+1))     /* otro marco */
                                   ;	                        tratarClickMarco() ;
                                   ;	                    else focalizarWin(win) ;             /* punto interior */
                                   ;	                }
                                   ;	                else actualizarCursor() ;
                                   ;	            }
                                   ;	#endif
                                   ;	        }
                                   ;	
000003F2  EB1F                  	jmp	short @19@9
000003F4                        @19@4:
                                   ;	
                                   ;	        else                              /* boton izquierdo no presionado */
                                   ;	        {
                                   ;	            if (moviendo)
                                   ;	
000003F4  833E380100            	cmp	word ptr DGROUP:_moviendo,0
000003F9  7408                  	je	short @19@6
                                   ;	
                                   ;	                moviendo = FALSE ;
                                   ;	
000003FB  C70638010000          	mov	word ptr DGROUP:_moviendo,0
00000401  EB0D                  	jmp	short @19@8
00000403                        @19@6:
                                   ;	
                                   ;	            else if (redimensionando)
                                   ;	
00000403  833E3A0100            	cmp	word ptr DGROUP:_redimensionando,0
00000408  7406                  	je	short @19@8
                                   ;	
                                   ;	                redimensionando = FALSE ;
                                   ;	
0000040A  C7063A010000          	mov	word ptr DGROUP:_redimensionando,0
00000410                        @19@8:
                                   ;	
                                   ;	            actualizarCursor() ;
                                   ;	
00000410  E8E700                	call	near ptr _actualizarCursor
00000413                        @19@9:
                                   ;	
                                   ;	        }
                                   ;	    }
                                   ;	}
                                   ;	
00000413  5D                    	pop	bp
00000414                        	ret	
00000415                        _procesarRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000415                        _procesarColaBloqueadosRaton	proc	near
                                   ;	
                                   ;	void procesarColaBloqueadosRaton ( void )
                                   ;	
00000415  C8040000              	enter	4,0
00000419  56                    	push	si
                                   ;	
                                   ;	{
                                   ;	
                                   ;	    pindx_t indProcesoActual ;
                                   ;	    pindx_t pindx ;
                                   ;	
                                   ;	    if (bloqueadosRaton.numElem > 0)
                                   ;	
0000041A  833E560000            	cmp	word ptr DGROUP:_bloqueadosRaton,0
0000041F  7F03                  	jg	@@3
00000421  E9D300                	jmp	@20@6
00000424                        @@3:
                                   ;	
                                   ;	    {
                                   ;	        pindx = bloqueadosRaton.primero ;
                                   ;	
00000424  A15800                	mov	ax,word ptr DGROUP:_bloqueadosRaton+2
00000427  8946FC                	mov	word ptr [bp-4],ax
                                   ;	
                                   ;	        indProcesoActual = *ptrIndProcesoActual ;
                                   ;	
0000042A  C41E0000              	les	bx,dword ptr DGROUP:_ptrIndProcesoActual
0000042E  268B07                	mov	ax,word ptr es:[bx]
00000431  8946FE                	mov	word ptr [bp-2],ax
                                   ;	
                                   ;	        if (indProcesoActual > -1)                          /* nivel 1 o 2 */
                                   ;	
00000434  837EFEFF              	cmp	word ptr [bp-2],-1
00000438  7E5E                  	jle	short @20@4
                                   ;	
                                   ;	        {
                                   ;	            ptrDescProceso[indProcesoActual].trama =
                                   ;	
                                   ;	
                                   ;	                (trama_t far *)MK_FP(*ptrSS_Proceso, *ptrSP_Proceso) ;
                                   ;	
0000043A  C41E2E00              	les	bx,dword ptr DGROUP:_ptrSS_Proceso
0000043E  268B07                	mov	ax,word ptr es:[bx]
00000441  33D2                  	xor	dx,dx
00000443  C41E3200              	les	bx,dword ptr DGROUP:_ptrSP_Proceso
00000447  260B17                	or	dx,word ptr es:[bx]
0000044A  8B5EFE                	mov	bx,word ptr [bp-2]
0000044D  69DBDC00              	imul	bx,bx,220
00000451  C4360C00              	les	si,dword ptr DGROUP:_ptrDescProceso
00000455  03F3                  	add	si,bx
00000457  26894408              	mov	word ptr es:[si+8],ax
0000045B  26895406              	mov	word ptr es:[si+6],dx
                                   ;	
                                   ;	            ptrDescProceso[indProcesoActual].estado = preparado ;
                                   ;	
0000045F  8B46FE                	mov	ax,word ptr [bp-2]
00000462  69C0DC00              	imul	ax,ax,220
00000466  C41E0C00              	les	bx,dword ptr DGROUP:_ptrDescProceso
0000046A  03D8                  	add	bx,ax
0000046C  26C747020100          	mov	word ptr es:[bx+2],1
                                   ;	
                                   ;	            encolarPC2c(indProcesoActual, (ptrC2c_t)&(ptrC2cPFR[PPreparados])) ;
                                   ;	
00000472  A11A00                	mov	ax,word ptr DGROUP:_ptrC2cPFR
00000475  83C014                	add	ax,20
00000478  FF361C00              	push	word ptr DGROUP:_ptrC2cPFR+2
0000047C  50                    	push	ax
0000047D  FF76FE                	push	word ptr [bp-2]
00000480  E80000                	call	near ptr _encolarPC2c
00000483  83C406                	add	sp,6
                                   ;	
                                   ;	            *ptrIndProcesoActual = -1 ;
                                   ;	
00000486  C41E0000              	les	bx,dword ptr DGROUP:_ptrIndProcesoActual
0000048A  26C707FFFF            	mov	word ptr es:[bx],-1
                                   ;	
                                   ;	            *ptrActivarAlEpilogo = TRUE ;
                                   ;	
0000048F  C41E0800              	les	bx,dword ptr DGROUP:_ptrActivarAlEpilogo
00000493  26C7070100            	mov	word ptr es:[bx],1
00000498                        @20@4:
                                   ;	
                                   ;	        }
                                   ;	
                                   ;	        do
                                   ;	        {
                                   ;	            memcpy(dirProceso[pindx], &er, nbytesProceso[pindx]) ;
                                   ;	
00000498  8B5EFC                	mov	bx,word ptr [bp-4]
0000049B  03DB                  	add	bx,bx
0000049D  FFB7A400              	push	word ptr DGROUP:_nbytesProceso[bx]
000004A1  1E                    	push	ds
000004A2  680901                	push	offset DGROUP:_er
000004A5  8B5EFC                	mov	bx,word ptr [bp-4]
000004A8  C1E302                	shl	bx,2
000004AB  FFB7C600              	push	word ptr DGROUP:_dirProceso[bx+2]
000004AF  FFB7C400              	push	word ptr DGROUP:_dirProceso[bx]
000004B3  E80000                	call	near ptr _memcpy
000004B6  83C40A                	add	sp,10
                                   ;	
                                   ;	
                                   ;	#if (FALSE)
                                   ;	
                                   ;	            switch (descProceso[pindx].trama->DX)
                                   ;	            {
                                   ;	            case 0 :
                                   ;	                if (descProceso[pindx].win != descProceso[indProcesoDeSuperficie].win) break ;
                                   ;	            case 1 :
                                   ;	                if (winVisible[estado->F][estado->C] != descProceso[pindx].win->num) break ;
                                   ;	            case 2 :
                                   ;	
                                   ;	                switch (descProceso[pindx].esperandoPor)
                                   ;	                {
                                   ;	                case rec_tecladoRaton :
                                   ;	                    eliminarPC2c(pindx, &descProceso[pindx].teclado->bloqueados) ;
                                   ;	                    descProceso[pindx].trama->AL = (char)0 ;
                                   ;	                    break ;
                                   ;	                case rec_tecladoRawRaton :
                                   ;	                    eliminarPC2c(pindx, &descProceso[pindx].teclado->bloqueadosRaw) ;
                                   ;	                    descProceso[pindx].trama->AX = 0x0000 ;
                                   ;	                    descProceso[pindx].trama->BX = 0x0000 ;           /* modificamos BX */
                                   ;	                    break ;
                                   ;	                }
                                   ;	#endif
                                   ;	                ptrDescProceso[pindx].estado = preparado ;
                                   ;	
000004B9  8B46FC                	mov	ax,word ptr [bp-4]
000004BC  69C0DC00              	imul	ax,ax,220
000004C0  C41E0C00              	les	bx,dword ptr DGROUP:_ptrDescProceso
000004C4  03D8                  	add	bx,ax
000004C6  26C747020100          	mov	word ptr es:[bx+2],1
                                   ;	
                                   ;	                encolarPC2c(pindx, (ptrC2c_t)&ptrC2cPFR[PUrgentes]) ;
                                   ;	
000004CC  A11A00                	mov	ax,word ptr DGROUP:_ptrC2cPFR
000004CF  83C01E                	add	ax,30
000004D2  FF361C00              	push	word ptr DGROUP:_ptrC2cPFR+2
000004D6  50                    	push	ax
000004D7  FF76FC                	push	word ptr [bp-4]
000004DA  E80000                	call	near ptr _encolarPC2c
000004DD  83C406                	add	sp,6
                                   ;	
                                   ;	#if (FALSE)
                                   ;	
                                   ;	            }
                                   ;	
                                   ;	#endif
                                   ;	
                                   ;	            desencolarPC2c(&bloqueadosRaton) ;
                                   ;	
000004E0  1E                    	push	ds
000004E1  685600                	push	offset DGROUP:_bloqueadosRaton
000004E4  E80000                	call	near ptr _desencolarPC2c
000004E7  83C404                	add	sp,4
                                   ;	
                                   ;	            pindx = bloqueadosRaton.primero ;
                                   ;	
000004EA  A15800                	mov	ax,word ptr DGROUP:_bloqueadosRaton+2
000004ED  8946FC                	mov	word ptr [bp-4],ax
                                   ;	
                                   ;	        }
                                   ;	        while (bloqueadosRaton.numElem > 0) ;
                                   ;	
000004F0  833E560000            	cmp	word ptr DGROUP:_bloqueadosRaton,0
000004F5  7FA1                  	jg	short @20@4
000004F7                        @20@6:
                                   ;	
                                   ;	    }
                                   ;	}
                                   ;	
000004F7  5E                    	pop	si
000004F8  C9                    	leave	
000004F9                        	ret	
000004FA                        _procesarColaBloqueadosRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
000004FA                        _actualizarCursor	proc	near
                                   ;	
                                   ;	void actualizarCursor ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    if (cursorRatonActivo)               /* actualizar el cursor del raton */
                                   ;	
000004FA  833E360100            	cmp	word ptr DGROUP:_cursorRatonActivo,0
000004FF  7503                  	jne	@@4
00000501  E9B800                	jmp	@21@15
00000504                        @@4:
                                   ;	
                                   ;	    {
                                   ;	        if (primeraInt) primeraInt = FALSE ;
                                   ;	
00000504  833E420100            	cmp	word ptr DGROUP:_primeraInt,0
00000509  7409                  	je	short @21@3
0000050B  C70642010000          	mov	word ptr DGROUP:_primeraInt,0
00000511  E9A800                	jmp	@21@15
00000514                        @21@3:
                                   ;	
                                   ;	        else if ((er.F != FAntCursor) || (er.C != CAntCursor))
                                   ;	
00000514  A11701                	mov	ax,word ptr DGROUP:_er+14
00000517  3B063001              	cmp	ax,word ptr DGROUP:_FAntCursor
0000051B  750C                  	jne	short @21@5
0000051D  A11901                	mov	ax,word ptr DGROUP:_er+16
00000520  3B063201              	cmp	ax,word ptr DGROUP:_CAntCursor
00000524  7503                  	jne	@@5
00000526  E99300                	jmp	@21@15
00000529                        @@5:
00000529                        @21@5:
                                   ;	
                                   ;	        {
                                   ;	            atrAux = ptrPant->t[FAntCursor][CAntCursor].atr ;
                                   ;	
00000529  8B1E3001              	mov	bx,word ptr DGROUP:_FAntCursor
0000052D  69DBA000              	imul	bx,bx,160
00000531  A13201                	mov	ax,word ptr DGROUP:_CAntCursor
00000534  03C0                  	add	ax,ax
00000536  03D8                  	add	bx,ax
00000538  B800B8                	mov	ax,-18432
0000053B  8EC0                  	mov	es,ax
0000053D  268A4701              	mov	al,byte ptr es:[bx+1]
00000541  A23401                	mov	byte ptr DGROUP:_atrAux,al
                                   ;	
                                   ;	//          atrAux = (atrAux << 4) | (atrAux >> 4) ; 
                                   ;	            if (atrAux != atrNormal)
                                   ;	
00000544  803E340107            	cmp	byte ptr DGROUP:_atrAux,7
00000549  7425                  	je	short @21@10
                                   ;	
                                   ;	            {
                                   ;	                rotarDerecha(atrAux, 4) ;
                                   ;	
0000054B  A03401                 	mov	 al,DGROUP:_atrAux 
0000054E  C0C804                 	ror	 al,4 
00000551  A23401                 	mov	 DGROUP:_atrAux,al 
                                   ;	
                                   ;	                ptrPant->t[FAntCursor][CAntCursor].atr = atrAux ;
                                   ;	
00000554  8B1E3001              	mov	bx,word ptr DGROUP:_FAntCursor
00000558  69DBA000              	imul	bx,bx,160
0000055C  A13201                	mov	ax,word ptr DGROUP:_CAntCursor
0000055F  03C0                  	add	ax,ax
00000561  03D8                  	add	bx,ax
00000563  B800B8                	mov	ax,-18432
00000566  8A163401              	mov	dl,byte ptr DGROUP:_atrAux
0000056A  8EC0                  	mov	es,ax
0000056C  26885701              	mov	byte ptr es:[bx+1],dl
00000570                        @21@10:
                                   ;	
                                   ;	            }
                                   ;	            atrAux = ptrPant->t[er.F][er.C].atr ;
                                   ;	
00000570  8B1E1701              	mov	bx,word ptr DGROUP:_er+14
00000574  69DBA000              	imul	bx,bx,160
00000578  A11901                	mov	ax,word ptr DGROUP:_er+16
0000057B  03C0                  	add	ax,ax
0000057D  03D8                  	add	bx,ax
0000057F  B800B8                	mov	ax,-18432
00000582  8EC0                  	mov	es,ax
00000584  268A4701              	mov	al,byte ptr es:[bx+1]
00000588  A23401                	mov	byte ptr DGROUP:_atrAux,al
                                   ;	
                                   ;	//          atrAux = (atrAux << 4) | (atrAux >> 4) ; 
                                   ;	            rotarDerecha(atrAux, 4) ;
                                   ;	
0000058B  A03401                 	mov	 al,DGROUP:_atrAux 
0000058E  C0C804                 	ror	 al,4 
00000591  A23401                 	mov	 DGROUP:_atrAux,al 
                                   ;	
                                   ;	            ptrPant->t[er.F][er.C].atr = atrAux ;
                                   ;	
00000594  8B1E1701              	mov	bx,word ptr DGROUP:_er+14
00000598  69DBA000              	imul	bx,bx,160
0000059C  A11901                	mov	ax,word ptr DGROUP:_er+16
0000059F  03C0                  	add	ax,ax
000005A1  03D8                  	add	bx,ax
000005A3  B800B8                	mov	ax,-18432
000005A6  8A163401              	mov	dl,byte ptr DGROUP:_atrAux
000005AA  8EC0                  	mov	es,ax
000005AC  26885701              	mov	byte ptr es:[bx+1],dl
                                   ;	
                                   ;	            FAntCursor = er.F ;
                                   ;	
000005B0  A11701                	mov	ax,word ptr DGROUP:_er+14
000005B3  A33001                	mov	word ptr DGROUP:_FAntCursor,ax
                                   ;	
                                   ;	            CAntCursor = er.C ;
                                   ;	
000005B6  A11901                	mov	ax,word ptr DGROUP:_er+16
000005B9  A33201                	mov	word ptr DGROUP:_CAntCursor,ax
000005BC                        @21@15:
                                   ;	
                                   ;	        }
                                   ;	    }
                                   ;	}
                                   ;	
000005BC                        	ret	
000005BD                        _actualizarCursor	endp
                                	assume	cs:_TEXT,ds:DGROUP
000005BD                        _handlerRatonNulo	proc	far
                                   ;	
                                   ;	void far handlerRatonNulo ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	}
                                   ;	
000005BD                        	ret	
000005BE                        _handlerRatonNulo	endp
000005BE                        _TEXT	ends
00000166                        _DATA	segment word public 'DATA'
00000166                        $adacdaia	label	word
00000166  01                    	db	1
00000167  00                    	db	0
00000168                        $igacdaia	label	word
00000168  00                    	db	0
00000169  00                    	db	0
0000016A                        $akacdaia	label	word
0000016A  00                    	db	0
0000016B  00                    	db	0
0000016C                        _DATA	ends
000005BE                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
000005BE                        _handlerRaton	proc	far
                                   ;	
                                   ;	void far handlerRaton ( dword_t y, word_t x, word_t s )
                                   ;	
000005BE  C8040000              	enter	4,0
                                   ;	
                                   ;	{
                                   ;	    static bool_t priVez = TRUE ;       /* para ignorar los incrementos .. */
                                   ;	    static int incX = 0, incY = 0 ;     /* .. X,Y iniciales que son basura */
                                   ;	    int X1 ;
                                   ;	    int Y1 ;
                                   ;	
                                   ;		setraw_DS() ;                         /* establecemos el DS del driver */
                                   ;	
000005C2  2EA10300               	mov	 ax,word ptr cs:[3] 
000005C6  8CCA                   	mov	 dx,cs 
000005C8  03C2                   	add	 ax,dx 
000005CA  8ED8                   	mov	 ds,ax 
                                   ;	
                                   ;		  
                                   ;	    if (priVez)
                                   ;	
000005CC  833E660100            	cmp	word ptr DGROUP:$adacdaia,0
000005D1  7408                  	je	short @23@7
                                   ;	
                                   ;	        priVez = FALSE ;       /* Ignoro la primera lectura por ser basura */
                                   ;	
000005D3  C70666010000          	mov	word ptr DGROUP:$adacdaia,0
000005D9  EB13                  	jmp	short @23@8
000005DB                        @23@7:
                                   ;	
                                   ;	    else
                                   ;	    {
                                   ;	        incX = x ;
                                   ;	
000005DB  8B460A                	mov	ax,word ptr [bp+10]
000005DE  A36801                	mov	word ptr DGROUP:$igacdaia,ax
                                   ;	
                                   ;	        incY = (word_t)(y >> 16) ; /* Tienen sentido respecto a MOVING/SIZING y */
                                   ;	
000005E1  8B5608                	mov	dx,word ptr [bp+8]
000005E4  89166A01              	mov	word ptr DGROUP:$akacdaia,dx
                                   ;	
                                   ;	        er.B0 = s ;             /* (s & BITS_IGN) | (M.stat & ~BITS_IGN) ; */
                                   ;	
000005E8  8A460C                	mov	al,byte ptr [bp+12]
000005EB  A20A01                	mov	byte ptr DGROUP:_er+1,al
000005EE                        @23@8:
                                   ;	
                                   ;	    }                                             /* Respeto los que habia */
                                   ;	//                                         /* Considero el bit de signo .. */
                                   ;	    if (s & 0x20) incY |= 0xFF00 ;           /* ..haciendo una extension.. */
                                   ;	
000005EE  F7460C2000            	test	word ptr [bp+12],32
000005F3  7406                  	je	short @23@10
000005F5  810E6A0100FF          	or	word ptr DGROUP:$akacdaia,-256
000005FB                        @23@10:
                                   ;	
                                   ;	    if (s & 0x10) incX |= 0xFF00 ;                   /* ..del bit de signo */
                                   ;	
000005FB  F7460C1000            	test	word ptr [bp+12],16
00000600  7406                  	je	short @23@12
00000602  810E680100FF          	or	word ptr DGROUP:$igacdaia,-256
00000608                        @23@12:
                                   ;	
                                   ;	    X1 = (er.X + incX) ;
                                   ;	
00000608  A11301                	mov	ax,word ptr DGROUP:_er+10
0000060B  03066801              	add	ax,word ptr DGROUP:$igacdaia
0000060F  8946FE                	mov	word ptr [bp-2],ax
                                   ;	
                                   ;	    Y1 = (er.Y - incY) ;
                                   ;	
00000612  A11501                	mov	ax,word ptr DGROUP:_er+12
00000615  2B066A01              	sub	ax,word ptr DGROUP:$akacdaia
00000619  8946FC                	mov	word ptr [bp-4],ax
                                   ;	
                                   ;	
                                   ;	    if (X1 < 0)             er.X = 0 ;
                                   ;	
0000061C  837EFE00              	cmp	word ptr [bp-2],0
00000620  7D08                  	jge	short @23@14
00000622  C70613010000          	mov	word ptr DGROUP:_er+10,0
00000628  EB15                  	jmp	short @23@17
0000062A                        @23@14:
                                   ;	
                                   ;	    else if (X1 >= maxX)    er.X = maxX-1 ;
                                   ;	
0000062A  817EFE8002            	cmp	word ptr [bp-2],640
0000062F  7C08                  	jl	short @23@16
00000631  C70613017F02          	mov	word ptr DGROUP:_er+10,639
00000637  EB06                  	jmp	short @23@17
00000639                        @23@16:
                                   ;	
                                   ;	    else                    er.X = X1 ;
                                   ;	
00000639  8B46FE                	mov	ax,word ptr [bp-2]
0000063C  A31301                	mov	word ptr DGROUP:_er+10,ax
0000063F                        @23@17:
                                   ;	
                                   ;	
                                   ;	    if (Y1 < 0)             er.Y = 0 ;
                                   ;	
0000063F  837EFC00              	cmp	word ptr [bp-4],0
00000643  7D08                  	jge	short @23@19
00000645  C70615010000          	mov	word ptr DGROUP:_er+12,0
0000064B  EB2D                  	jmp	short @23@22
0000064D                        @23@19:
                                   ;	
                                   ;	    else if (Y1 >= maxYAct) er.Y = maxYAct-1 ;
                                   ;	
0000064D  33C0                  	xor	ax,ax
0000064F  8EC0                  	mov	es,ax
00000651  26A08404              	mov	al,byte ptr es:[1156]
00000655  B400                  	mov	ah,0
00000657  40                    	inc	ax
00000658  C1E003                	shl	ax,3
0000065B  3B46FC                	cmp	ax,word ptr [bp-4]
0000065E  7F14                  	jg	short @23@21
00000660  33C0                  	xor	ax,ax
00000662  8EC0                  	mov	es,ax
00000664  26A08404              	mov	al,byte ptr es:[1156]
00000668  B400                  	mov	ah,0
0000066A  40                    	inc	ax
0000066B  C1E003                	shl	ax,3
0000066E  48                    	dec	ax
0000066F  A31501                	mov	word ptr DGROUP:_er+12,ax
00000672  EB06                  	jmp	short @23@22
00000674                        @23@21:
                                   ;	
                                   ;	    else                    er.Y = Y1 ;
                                   ;	
00000674  8B46FC                	mov	ax,word ptr [bp-4]
00000677  A31501                	mov	word ptr DGROUP:_er+12,ax
0000067A                        @23@22:
                                   ;	
                                   ;	}
                                   ;	
0000067A  C9                    	leave	
0000067B                        	ret	
0000067C                        _handlerRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000067C                        _finishRaton	proc	near
                                   ;	
                                   ;	int finishRaton ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    exit(0) ;
                                   ;	
0000067C  6A00                  	push	0
0000067E  E80000                	call	near ptr _exit
00000681  59                    	pop	cx
                                   ;	
                                   ;	    return(0) ;
                                   ;	
00000682  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
00000684                        	ret	
00000685                        _finishRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000685                        _finCodeDriver	proc	near
                                   ;	
                                   ;	void finCodeDriver ( void )   /* marca el fin del codigo propio del driver */
                                   ;	
                                   ;	
                                   ;	{
                                   ;	}
                                   ;	
00000685                        	ret	
00000686                        _finCodeDriver	endp
00000686                        _TEXT	ends
0000016C                        _DATA	segment word public 'DATA'
0000016C                        _descCcbRaton	label	word
0000016C  00                    	db	0
0000016D  00                    	db	0
0000016E  00                    	db	0
0000016F  00                    	db	0
00000170  00                    	db	0
00000171  00                    	db	0
00000172  09                    	db	9
00000173  00                    	db	0
00000174  00                    	db	0
00000175  00                    	db	0
00000176  00                    	db	0
00000177  00                    	db	0
00000178  00                    	db	0
00000179  00                    	db	0
0000017A  00                    	db	0
0000017B  00                    	db	0
0000017C  00                    	db	0
0000017D  00                    	db	0
0000017E  00                    	db	0
0000017F  00                    	db	0
00000180  00                    	db	0
00000181  00                    	db	0
00000182  00                    	db	0
00000183  00                    	db	0
00000184  00                    	db	0
00000185  00                    	db	0
00000186  00                    	db	0
00000187  00                    	db	0
00000188  00                    	db	0
00000189  00                    	db	0
0000018A  00                    	db	0
0000018B  00                    	db	0
0000018C  00                    	db	0
0000018D  00                    	db	0
0000018E  00                    	db	0
0000018F  00                    	db	0
00000190  00                    	db	0
00000191  00                    	db	0
00000192  00                    	db	0
00000193  00                    	db	0
00000194  00                    	db	0
00000195  00                    	db	0
00000196  00                    	db	0
00000197  00                    	db	0
00000198  00                    	db	0
00000199  00                    	db	0
0000019A  00                    	db	0
0000019B  00                    	db	0
0000019C                        _DATA	ends
00000686                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
00000686                        _outKBD	proc	near
                                   ;	
                                   ;	void outKBD ( byte_t puerto,   /* envia un comando al dispositivo auxiliar */
                                   ;	
00000686  55                    	push	bp
00000687  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	              byte_t valor )
                                   ;	{
                                   ;	asm 
                                   ;	{ 
                                   ;	    mov dl,puerto ;
                                   ;	
00000689  8A5604                	mov	 dl,[bp+4] 
                                   ;	
                                   ;	    mov dh,valor ;
                                   ;	
0000068C  8A7606                	mov	 dh,[bp+6] 
                                   ;	
                                   ;	    push dx ;
                                   ;	
0000068F  52                    	push	 dx 
                                   ;	
                                   ;	    xor dx,dx ;
                                   ;	
00000690  33D2                  	xor	 dx,dx 
                                   ;	
                                   ;	    mov es,dx ;
                                   ;	
00000692  8EC2                  	mov	 es,dx 
00000694                        @26@6:
                                   ;	
                                   ;	outKBD_0: ;
                                   ;	
00000694                        outKBD_0:
                                 	;	
                                   ;	
                                   ;	    mov dl,byte ptr es:[046Ch] ;                             /* BIOS_timer */
                                   ;	
00000694  268A166C04            	mov	 dl,byte ptr es:[046Ch] 
00000699                        @26@9:
                                   ;	
                                   ;	outKBD_1: ;
                                   ;	
00000699                        outKBD_1:
                                 	;	
                                   ;	
                                   ;	    in al,64h ;                                         /* keyboard status */
                                   ;	
00000699  E464                  	in	 al,64h 
                                   ;	
                                   ;	    test al,00000010b ;                    /* =2 check if we can send data */
                                   ;	
0000069B  A802                  	test	 al,00000010b 
                                   ;	
                                   ;	    jmp outKBD_2 ;                           /* jump if write buffer empty */
                                   ;	
0000069D  EB0C                  	jmp	short @26@18
                                   ;	
                                   ;	    cmp dl,byte ptr es:[046Ch] ;                             /* BIOS_timer */
                                   ;	
0000069F  263A166C04            	cmp	 dl,byte ptr es:[046Ch] 
                                   ;	
                                   ;	    je outKBD_1 ;
                                   ;	
000006A4  74F3                  	je	short @26@9
                                   ;	
                                   ;	    xor dh,1 ;
                                   ;	
000006A6  80F601                	xor	 dh,1 
                                   ;	
                                   ;	    jnz outKBD_0 ;
                                   ;	
000006A9  75E9                  	jne	short @26@6
000006AB                        @26@18:
                                   ;	
                                   ;	outKBD_2: ;
                                   ;	
000006AB                        outKBD_2:
                                 	;	
                                   ;	
                                   ;	    pop dx ;
                                   ;	
000006AB  5A                    	pop	 dx 
                                   ;	
                                   ;	    mov al,dh ;
                                   ;	
000006AC  8AC6                  	mov	 al,dh 
                                   ;	
                                   ;	    mov dh,0 ;
                                   ;	
000006AE  B600                  	mov	 dh,0 
                                   ;	
                                   ;	    out dx,al ;
                                   ;	
000006B0  EE                    	out	 dx,al 
                                   ;	
                                   ;	}
                                   ;	}
                                   ;	
000006B1  5D                    	pop	bp
000006B2                        	ret	
000006B3                        _outKBD	endp
                                	assume	cs:_TEXT,ds:DGROUP
000006B3                        _flushKBD	proc	near
                                   ;	
                                   ;	void flushKBD ( byte_t puerto,         /* Send command to auxiliary device */
                                   ;	
000006B3  55                    	push	bp
000006B4  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	                byte_t valor )
                                   ;	{
                                   ;	    outKBD(puerto, valor) ;
                                   ;	
000006B6  8A4606                	mov	al,byte ptr [bp+6]
000006B9  50                    	push	ax
000006BA  8A4604                	mov	al,byte ptr [bp+4]
000006BD  50                    	push	ax
000006BE  E8C5FF                	call	near ptr _outKBD
000006C1  83C404                	add	sp,4
                                   ;	
                                   ;	asm 
                                   ;	{
                                   ;	    mov ah,0 ;
                                   ;	
000006C4  B400                  	mov	 ah,0 
000006C6                        @27@3:
                                   ;	
                                   ;	flushKBD_0: ;
                                   ;	
000006C6                        flushKBD_0:
                                 	;	
                                   ;	
                                   ;	    xor dx,dx ;
                                   ;	
000006C6  33D2                  	xor	 dx,dx 
                                   ;	
                                   ;	    mov es,dx ;
                                   ;	
000006C8  8EC2                  	mov	 es,dx 
000006CA                        @27@7:
                                   ;	
                                   ;	flushKBD_1: ;
                                   ;	
000006CA                        flushKBD_1:
                                 	;	
                                   ;	
                                   ;	    mov dl,byte ptr es:[046Ch] ;                             /* BIOS_timer */
                                   ;	
000006CA  268A166C04            	mov	 dl,byte ptr es:[046Ch] 
000006CF                        @27@10:
                                   ;	
                                   ;	flushKBD_2: ;
                                   ;	
000006CF                        flushKBD_2:
                                 	;	
                                   ;	
                                   ;	    in al,64h ;                                         /* keyboard status */
                                   ;	
000006CF  E464                  	in	 al,64h 
                                   ;	
                                   ;	    test al,00000001b ;                          /* =1 if read buffer full */
                                   ;	
000006D1  A801                  	test	 al,00000001b 
                                   ;	
                                   ;	    jz flushKBD_3 ;
                                   ;	
000006D3  7406                  	je	short @27@18
                                   ;	
                                   ;	    in al,60h ;
                                   ;	
000006D5  E460                  	in	 al,60h 
                                   ;	
                                   ;	    mov ah,al ;
                                   ;	
000006D7  8AE0                  	mov	 ah,al 
                                   ;	
                                   ;	    jmp flushKBD_0 ;
                                   ;	
000006D9  EBEB                  	jmp	short @27@3
000006DB                        @27@18:
                                   ;	
                                   ;	flushKBD_3: ;
                                   ;	
000006DB                        flushKBD_3:
                                 	;	
                                   ;	
                                   ;	    cmp dl,byte ptr es:[046Ch]                               /* BIOS_timer */
                                   ;	
000006DB  263A166C04            	cmp	 dl,byte ptr es:[046Ch]                               
                                   ;	
                                   ;	    je flushKBD_2
                                   ;	
000006E0  74ED                  	je	short @27@10
                                   ;	
                                   ;	    xor dh,1
                                   ;	
000006E2  80F601                	xor	 dh,1
                                   ;	
                                   ;	    jnz flushKBD_1
                                   ;	
000006E5  75E3                  	jne	short @27@7
                                   ;	
                                   ;	}	
                                   ;	}
                                   ;	
000006E7  5D                    	pop	bp
000006E8                        	ret	
000006E9                        _flushKBD	endp
                                	assume	cs:_TEXT,ds:DGROUP
000006E9                        _setRate	proc	near
                                   ;	
                                   ;	void setRate ( byte_t rate )
                                   ;	
000006E9  55                    	push	bp
000006EA  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	{
                                   ;	
                                   ;	    outKBD(0x64, 0x0D4) ;                        /* enable mouse functions */
                                   ;	
000006EC  68D400                	push	212
000006EF  6A64                  	push	100
000006F1  E892FF                	call	near ptr _outKBD
000006F4  83C404                	add	sp,4
                                   ;	
                                   ;	    flushKBD(0x60, 0x0F3) ;                      /* set rate...            */
                                   ;	
000006F7  68F300                	push	243
000006FA  6A60                  	push	96
000006FC  E8B4FF                	call	near ptr _flushKBD
000006FF  83C404                	add	sp,4
                                   ;	
                                   ;	//                                /* should be 0FAh (ACK) or 0FEh (resend) */
                                   ;	    outKBD(0x64, 0x0D4) ;                        /* enable mouse functions */
                                   ;	
00000702  68D400                	push	212
00000705  6A64                  	push	100
00000707  E87CFF                	call	near ptr _outKBD
0000070A  83C404                	add	sp,4
                                   ;	
                                   ;	    flushKBD(0x60, rate) ;                       /* ...value               */
                                   ;	
0000070D  8A4604                	mov	al,byte ptr [bp+4]
00000710  50                    	push	ax
00000711  6A60                  	push	96
00000713  E89DFF                	call	near ptr _flushKBD
00000716  83C404                	add	sp,4
                                   ;	
                                   ;	//                                /* should be 0FAh (ACK) or 0FEh (resend) */
                                   ;	}
                                   ;	
00000719  5D                    	pop	bp
0000071A                        	ret	
0000071B                        _setRate	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000071B                        _PS2dummy	proc	far
                                   ;	
                                   ;	void far PS2dummy ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	}
                                   ;	
0000071B                        	ret	
0000071C                        _PS2dummy	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000071C                        _checkPS2	proc	near
                                   ;	
                                   ;	bool_t checkPS2 ( printCar_t pCar )
                                   ;	
0000071C  55                    	push	bp
0000071D  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	{
                                   ;	asm
                                   ;	{
                                   ;	    int 11h ;                                        /* get equipment list */
                                   ;	
0000071F  CD11                  	int	 11h 
                                   ;	
                                   ;	    and al,00000100b ;                                  /* 00000100 HW_PS2 */
                                   ;	
00000721  2404                  	and	 al,00000100b 
                                   ;	
                                   ;	    jz noPS2 ;                               /* jump if PS/2 not indicated */
                                   ;	
00000723  7476                  	je	short @30@33
                                   ;	
                                   ;	
                                   ;	    mov bh,3 ;
                                   ;	
00000725  B703                  	mov	 bh,3 
                                   ;	
                                   ;	    mov ax,0C205h ;                    /* inicializar raton, bh = datasize */
                                   ;	
00000727  B805C2                	mov	 ax,0C205h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
0000072A  CD15                  	int	 15h 
                                   ;	
                                   ;	    jc noPS2 ;
                                   ;	
0000072C  726D                  	jc	short @30@33
                                   ;	
                                   ;	    test ah,ah ;
                                   ;	
0000072E  84E4                  	test	 ah,ah 
                                   ;	
                                   ;	    jnz noPS2 ;
                                   ;	
00000730  7569                  	jne	short @30@33
                                   ;	
                                   ;	
                                   ;	    mov bh,3 ;
                                   ;	
00000732  B703                  	mov	 bh,3 
                                   ;	
                                   ;	    mov ax,0C203h ;             /* establecer la resolucin del raton (bh) */
                                   ;	
00000734  B803C2                	mov	 ax,0C203h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
00000737  CD15                  	int	 15h 
                                   ;	
                                   ;	    jc noPS2 ;
                                   ;	
00000739  7260                  	jc	short @30@33
                                   ;	
                                   ;	    test ah,ah ;
                                   ;	
0000073B  84E4                  	test	 ah,ah 
                                   ;	
                                   ;	    jnz noPS2 ;
                                   ;	
0000073D  755C                  	jne	short @30@33
                                   ;	
                                   ;	
                                   ;	    push cs ;
                                   ;	
0000073F  0E                    	push	 cs 
                                   ;	
                                   ;	    pop es ;
                                   ;	
00000740  07                    	pop	 es 
                                   ;	
                                   ;	    mov bx,OFFSET PS2dummy ;
                                   ;	
00000741  BB1B07                	mov	 bx,OFFSET _PS2dummy 
                                   ;	
                                   ;	    mov ax,0C207h ;                    /* establecer mouse handler (ES:BX) */
                                   ;	
00000744  B807C2                	mov	 ax,0C207h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
00000747  CD15                  	int	 15h 
                                   ;	
                                   ;	    jc noPS2 ;
                                   ;	
00000749  7250                  	jc	short @30@33
                                   ;	
                                   ;	    test ah,ah ;
                                   ;	
0000074B  84E4                  	test	 ah,ah 
                                   ;	
                                   ;	    jnz noPS2 ;
                                   ;	
0000074D  754C                  	jne	short @30@33
                                   ;	
                                   ;	
                                   ;	    xor bx,bx ;
                                   ;	
0000074F  33DB                  	xor	 bx,bx 
                                   ;	
                                   ;	    mov es,bx ;
                                   ;	
00000751  8EC3                  	mov	 es,bx 
                                   ;	
                                   ;	    mov ax,0C207h ;                        /* borrar mouse handler (ES:BX) */
                                   ;	
00000753  B807C2                	mov	 ax,0C207h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
00000756  CD15                  	int	 15h 
                                   ;	
                                   ;	//                          /* select IntelliMouse Z wheel + 3 button mode */
                                   ;	    pushf ;
                                   ;	
00000758  9C                    	pushf	 
                                   ;	
                                   ;	    sti ;
                                   ;	
00000759  FB                    	sti	 
                                   ;	
                                   ;	}
                                   ;	    pCar('.') ;
                                   ;	
0000075A  6A2E                  	push	46
0000075C  FF5604                	call	word ptr [bp+4]
0000075F  59                    	pop	cx
                                   ;	
                                   ;	    setRate(200) ;                          /* 200->100->80 rate does this */
                                   ;	
00000760  68C800                	push	200
00000763  E883FF                	call	near ptr _setRate
00000766  59                    	pop	cx
                                   ;	
                                   ;	    pCar('.') ;
                                   ;	
00000767  6A2E                  	push	46
00000769  FF5604                	call	word ptr [bp+4]
0000076C  59                    	pop	cx
                                   ;	
                                   ;	    setRate(100) ;
                                   ;	
0000076D  6A64                  	push	100
0000076F  E877FF                	call	near ptr _setRate
00000772  59                    	pop	cx
                                   ;	
                                   ;	    pCar('.') ;
                                   ;	
00000773  6A2E                  	push	46
00000775  FF5604                	call	word ptr [bp+4]
00000778  59                    	pop	cx
                                   ;	
                                   ;	    setRate( 80) ;
                                   ;	
00000779  6A50                  	push	80
0000077B  E86BFF                	call	near ptr _setRate
0000077E  59                    	pop	cx
                                   ;	
                                   ;	//                                                   /* check if sucessful */
                                   ;	    outKBD(0x64, 0x0D4) ;                        /* enable mouse functions */
                                   ;	
0000077F  68D400                	push	212
00000782  6A64                  	push	100
00000784  E8FFFE                	call	near ptr _outKBD
00000787  83C404                	add	sp,4
                                   ;	
                                   ;	    flushKBD(0x60, 0x0F2) ;                      /* get ID en ah           */
                                   ;	
0000078A  68F200                	push	242
0000078D  6A60                  	push	96
0000078F  E821FF                	call	near ptr _flushKBD
00000792  83C404                	add	sp,4
                                   ;	
                                   ;	//                                               /* ID=3 -> 3 button+wheel */
                                   ;	    asm popf
                                   ;	
00000795  9D                     	popf	
                                   ;	
                                   ;	
                                   ;	    return(TRUE) ;                                          /* =PS/2 mouse */
                                   ;	
00000796  B80100                	mov	ax,1
00000799  5D                    	pop	bp
0000079A                        	ret	
0000079B                        @30@33:
                                   ;	
                                   ;	noPS2:
                                   ;	    return(FALSE) ;
                                   ;	
0000079B  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
0000079D  5D                    	pop	bp
0000079E                        	ret	
0000079F                        _checkPS2	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000079F                        _disablePS2	proc	near
                                   ;	
                                   ;	void disablePS2 ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    asm pushf ;
                                   ;	
0000079F  9C                     	pushf	 
                                   ;	
                                   ;	    asm cli ;
                                   ;	
000007A0  FA                     	cli	 
                                   ;	
                                   ;	    ptrTVI[nVIntRaton] = rtiRatonOrg ;  /* falta actualizar la mascara de interrupcion del pic ?? */
                                   ;	
000007A1  C41E0000              	les	bx,dword ptr DGROUP:_ptrTVI
000007A5  8B160400              	mov	dx,word ptr DGROUP:_rtiRatonOrg+2
000007A9  A10200                	mov	ax,word ptr DGROUP:_rtiRatonOrg
000007AC  268997D201            	mov	word ptr es:[bx+466],dx
000007B1  268987D001            	mov	word ptr es:[bx+464],ax
                                   ;	
                                   ;	    asm popf ;
                                   ;	
000007B6  9D                     	popf	 
                                   ;	
                                   ;	//                                         /* restablecerInt(nVIntRaton) ; */
                                   ;	asm
                                   ;	{
                                   ;	    xor bx,bx ;
                                   ;	
000007B7  33DB                  	xor	 bx,bx 
                                   ;	
                                   ;	    mov ax,0C200h ;                                       /* set mouse off */
                                   ;	
000007B9  B800C2                	mov	 ax,0C200h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
000007BC  CD15                  	int	 15h 
                                   ;	
                                   ;	
                                   ;	    mov es,bx ;
                                   ;	
000007BE  8EC3                  	mov	 es,bx 
                                   ;	
                                   ;	    mov ax,0C207h ;                      /* borrar mouse handler (ES:BX=0) */
                                   ;	
000007C0  B807C2                	mov	 ax,0C207h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
000007C3  CD15                  	int	 15h 
                                   ;	
                                   ;	}
                                   ;	}
                                   ;	
000007C5                        	ret	
000007C6                        _disablePS2	endp
000007C6                        _TEXT	ends
00000000                        _BSS	segment word public 'BSS'
00000000                        $aedcdaia	label	word
00000000  0000                  	db	2 dup (?)
00000002                        _BSS	ends
000007C6                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
000007C6                        _enablePS2	proc	near
                                   ;	
                                   ;	void enablePS2 ( handler_t handler )
                                   ;	
000007C6  55                    	push	bp
000007C7  8BEC                  	mov	bp,sp
                                   ;	
                                   ;	{
                                   ;	    static word_t handlerWord ;
                                   ;	
                                   ;	    handlerWord = FP_OFF(handler) ;
                                   ;	
000007C9  8B4604                	mov	ax,word ptr [bp+4]
000007CC  A30000                	mov	word ptr DGROUP:$aedcdaia,ax
                                   ;	
                                   ;	asm 
                                   ;	{
                                   ;	    mov bx,0 ;
                                   ;	
000007CF  BB0000                	mov	 bx,0 
                                   ;	
                                   ;	    mov ax,0C200h ;                                       /* set mouse off */
                                   ;	
000007D2  B800C2                	mov	 ax,0C200h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
000007D5  CD15                  	int	 15h 
                                   ;	
                                   ;	
                                   ;	    mov bh,3 ;
                                   ;	
000007D7  B703                  	mov	 bh,3 
                                   ;	
                                   ;	    mov ax,0C205h ;                    /* inicializar raton, bh = datasize */
                                   ;	
000007D9  B805C2                	mov	 ax,0C205h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
000007DC  CD15                  	int	 15h 
                                   ;	
                                   ;	
                                   ;	    mov bh,3 ;
                                   ;	
000007DE  B703                  	mov	 bh,3 
                                   ;	
                                   ;	    mov ax,0C203h ;             /* establecer la resolucion del raton (bh) */
                                   ;	
000007E0  B803C2                	mov	 ax,0C203h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
000007E3  CD15                  	int	 15h 
                                   ;	
                                   ;	
                                   ;	#if (FALSE)
                                   ;	    mov bx,0 ;
                                   ;	    mov es,bx ;
                                   ;	    mov ax,0C207h ;                      /* borrar mouse handler (ES:BX=0) */
                                   ;	    int 15h ;
                                   ;	#endif
                                   ;	
                                   ;	    push cs ;
                                   ;	
000007E5  0E                    	push	 cs 
                                   ;	
                                   ;	    pop es ;
                                   ;	
000007E6  07                    	pop	 es 
                                   ;	
                                   ;	    mov bx,handlerWord ;           /* necesitamos handlerWordl static (DS) */
                                   ;	
000007E7  8B1E0000              	mov	 bx,$aedcdaia 
                                   ;	
                                   ;	    mov ax,0C207h ;
                                   ;	
000007EB  B807C2                	mov	 ax,0C207h 
                                   ;	
                                   ;	    int 15h ;               /* Establece mouse handler ES:BX=handler_Raton */
                                   ;	
000007EE  CD15                  	int	 15h 
                                   ;	
                                   ;	
                                   ;	    mov bh,1 ;
                                   ;	
000007F0  B701                  	mov	 bh,1 
                                   ;	
                                   ;	    mov ax,0C200h ;                                        /* set mouse on */
                                   ;	
000007F2  B800C2                	mov	 ax,0C200h 
                                   ;	
                                   ;	    int 15h ;
                                   ;	
000007F5  CD15                  	int	 15h 
                                   ;	
                                   ;	}
                                   ;	}
                                   ;	
000007F7  5D                    	pop	bp
000007F8                        	ret	
000007F9                        _enablePS2	endp
                                	assume	cs:_TEXT,ds:DGROUP
000007F9                        _noPrintCar	proc	near
                                   ;	
                                   ;	void noPrintCar ( )                          /* no se utiliza el argumento */
                                   ;	
                                   ;	
                                   ;	{
                                   ;	}
                                   ;	
000007F9                        	ret	
000007FA                        _noPrintCar	endp
                                	assume	cs:_TEXT,ds:DGROUP
000007FA                        _inicRaton	proc	near
                                   ;	
                                   ;	void inicRaton ( tipoRaton_t * tipoRaton,
                                   ;	
000007FA  C8140000              	enter	20,0
                                   ;	
                                   ;	                 isr_t       * isrRaton,
                                   ;	                 bool_t        conMensajes)
                                   ;	{
                                   ;	    word_t numBotones ;
                                   ;	
                                   ;	    info_t info ;
                                   ;	
                                   ;	    bool_t hayNT ;
                                   ;	    bool_t hayDBox ;
                                   ;	
                                   ;	    printCar_t pCar ;
                                   ;	
                                   ;	    obtenInfoINFO((info_t far *)&info) ;
                                   ;	
000007FE  16                    	push	ss
000007FF  8D46EC                	lea	ax,word ptr [bp-20]
00000802  50                    	push	ax
00000803  E80000                	call	near ptr _obtenInfoINFO
00000806  83C404                	add	sp,4
                                   ;	
                                   ;	
                                   ;	    hayNT = FALSE ;
                                   ;	
00000809  C746FC0000            	mov	word ptr [bp-4],0
                                   ;	
                                   ;	    switch (info.modoSO1)
                                   ;	
0000080E  8B46F2                	mov	ax,word ptr [bp-14]
00000811  83F802                	cmp	ax,2
00000814  7407                  	je	short @34@6
00000816  83F803                	cmp	ax,3
00000819  7402                  	je	short @34@6
0000081B  EB06                  	jmp	short @34@7
0000081D                        @34@6:
                                   ;	
                                   ;	    {
                                   ;	    case modoSO1_Com :                                          /* so1.com */
                                   ;	    case modoSO1_Exe :                                          /* so1.exe */
                                   ;	        hayNT = (bool_t)(hayWindowsNT()) ;
                                   ;	
0000081D  E80000                	call	near ptr _hayWindowsNT
00000820  8946FC                	mov	word ptr [bp-4],ax
00000823                        @34@7:
                                   ;	
                                   ;	    default :
                                   ;	        ;
                                   ;	    } ;
                                   ;	
                                   ;	    hayDBox = (bool_t)(!strncmp((char far *)ptrFechaBios, "01/01/92", 8)) ;
                                   ;	
00000823  6A08                  	push	8
00000825  1E                    	push	ds
00000826  68B401                	push	offset DGROUP:s@
00000829  6AFF                  	push	-1
0000082B  6A05                  	push	5
0000082D  E80000                	call	near ptr _strncmp
00000830  83C40A                	add	sp,10
00000833  F7D8                  	neg	ax
00000835  1BC0                  	sbb	ax,ax
00000837  40                    	inc	ax
00000838  8946FA                	mov	word ptr [bp-6],ax
                                   ;	
                                   ;	
                                   ;	    if (conMensajes)
                                   ;	
0000083B  837E0800              	cmp	word ptr [bp+8],0
0000083F  7420                  	je	short @34@12
                                   ;	
                                   ;	    {
                                   ;	        if (hayNT) printf("\n\n hayNT ") ;
                                   ;	
00000841  837EFC00              	cmp	word ptr [bp-4],0
00000845  740A                  	je	short @34@10
00000847  1E                    	push	ds
00000848  68BD01                	push	offset DGROUP:s@+9
0000084B  E80000                	call	near ptr _printf
0000084E  83C404                	add	sp,4
00000851                        @34@10:
                                   ;	
                                   ;	        if (hayDBox) printf("\n\n hayDBox ") ;
                                   ;	
00000851  837EFA00              	cmp	word ptr [bp-6],0
00000855  740A                  	je	short @34@12
00000857  1E                    	push	ds
00000858  68C701                	push	offset DGROUP:s@+19
0000085B  E80000                	call	near ptr _printf
0000085E  83C404                	add	sp,4
00000861                        @34@12:
                                   ;	
                                   ;	    }
                                   ;	
                                   ;	    *tipoRaton = ninguno ;
                                   ;	
00000861  8B5E04                	mov	bx,word ptr [bp+4]
00000864  C7070000              	mov	word ptr [bx],0
                                   ;	
                                   ;	
                                   ;	    inicEstadoRaton() ;
                                   ;	
00000868  E895F7                	call	near ptr _inicEstadoRaton
                                   ;	
                                   ;	    if (hayNT)
                                   ;	
0000086B  837EFC00              	cmp	word ptr [bp-4],0
0000086F  7444                  	je	short @34@17
                                   ;	
                                   ;	    {
                                   ;	        resetRatonBIOS((word_t *)&numBotones) ;
                                   ;	
00000871  8D46FE                	lea	ax,word ptr [bp-2]
00000874  50                    	push	ax
00000875  E80000                	call	near ptr _resetRatonBIOS
00000878  59                    	pop	cx
                                   ;	
                                   ;	        if (hayRatonBIOS())                         /* raton msdos int 33h */
                                   ;	
00000879  E80000                	call	near ptr _hayRatonBIOS
0000087C  0BC0                  	or	ax,ax
0000087E  7425                  	je	short @34@15
                                   ;	
                                   ;	        {
                                   ;	            *tipoRaton = msdos ;                         /* WinXP o DOSBox */
                                   ;	
00000880  8B5E04                	mov	bx,word ptr [bp+4]
00000883  C7070100              	mov	word ptr [bx],1
                                   ;	
                                   ;	            *isrRaton = isr_raton_BIOS ;
                                   ;	
00000887  8B5E06                	mov	bx,word ptr [bp+6]
0000088A  C747020000            	mov	word ptr [bx+2],seg _isr_raton_BIOS
0000088F  C707ED01              	mov	word ptr [bx],offset _isr_raton_BIOS
                                   ;	
                                   ;	            installMouseEventHandler(     
                                   ;	
                                   ;	
                                   ;	                (handler_t)MK_FP(_CS, FP_OFF(ratonHandler))     
                                   ;	            ) ;
                                   ;	
00000893  8CC8                  	mov	ax,cs
00000895  33D2                  	xor	dx,dx
00000897  81CA4202              	or	dx,offset _ratonHandler
0000089B  50                    	push	ax
0000089C  52                    	push	dx
0000089D  E80000                	call	near ptr _installMouseEventHandler
000008A0  83C404                	add	sp,4
                                   ;	
                                   ;	        }
                                   ;	
000008A3  EB10                  	jmp	short @34@17
000008A5                        @34@15:
                                   ;	
                                   ;	        else if (conMensajes)
                                   ;	
000008A5  837E0800              	cmp	word ptr [bp+8],0
000008A9  740A                  	je	short @34@17
                                   ;	
                                   ;	            printf("\n\n no hay raton BIOS ") ;
                                   ;	
000008AB  1E                    	push	ds
000008AC  68D301                	push	offset DGROUP:s@+31
000008AF  E80000                	call	near ptr _printf
000008B2  83C404                	add	sp,4
000008B5                        @34@17:
                                   ;	
                                   ;	    }
                                   ;	    if (*tipoRaton == ninguno)
                                   ;	
000008B5  8B5E04                	mov	bx,word ptr [bp+4]
000008B8  833F00                	cmp	word ptr [bx],0
000008BB  7403                  	je	@@6
000008BD  E99400                	jmp	@34@33
000008C0                        @@6:
                                   ;	
                                   ;	    {
                                   ;	        if (conMensajes)
                                   ;	
000008C0  837E0800              	cmp	word ptr [bp+8],0
000008C4  740A                  	je	short @34@20
                                   ;	
                                   ;	            printf("\n\n comprobando si hay raton PS/2 ") ;
                                   ;	
000008C6  1E                    	push	ds
000008C7  68E901                	push	offset DGROUP:s@+53
000008CA  E80000                	call	near ptr _printf
000008CD  83C404                	add	sp,4
000008D0                        @34@20:
                                   ;	
                                   ;	        if (conMensajes)
                                   ;	
000008D0  837E0800              	cmp	word ptr [bp+8],0
000008D4  7407                  	je	short @34@22
                                   ;	
                                   ;	            pCar = escribirCar ;
                                   ;	
000008D6  C746F80000            	mov	word ptr [bp-8],offset _escribirCar
000008DB  EB05                  	jmp	short @34@23
000008DD                        @34@22:
                                   ;	
                                   ;	        else
                                   ;	            pCar = (printCar_t)noPrintCar ;
                                   ;	
000008DD  C746F8F907            	mov	word ptr [bp-8],offset _noPrintCar
000008E2                        @34@23:
                                   ;	
                                   ;	        if (checkPS2(pCar))
                                   ;	
000008E2  FF76F8                	push	word ptr [bp-8]
000008E5  E834FE                	call	near ptr _checkPS2
000008E8  59                    	pop	cx
000008E9  0BC0                  	or	ax,ax
000008EB  7451                  	je	short @34@30
                                   ;	
                                   ;	        {
                                   ;	            if (conMensajes)
                                   ;	
000008ED  837E0800              	cmp	word ptr [bp+8],0
000008F1  740A                  	je	short @34@26
                                   ;	
                                   ;	                printf(" Ok") ;
                                   ;	
000008F3  1E                    	push	ds
000008F4  680B02                	push	offset DGROUP:s@+87
000008F7  E80000                	call	near ptr _printf
000008FA  83C404                	add	sp,4
000008FD                        @34@26:
                                   ;	
                                   ;	            *tipoRaton = ps2 ;                                /* raton PS2 */
                                   ;	
000008FD  8B5E04                	mov	bx,word ptr [bp+4]
00000900  C7070200              	mov	word ptr [bx],2
                                   ;	
                                   ;	            if (hayDBox)                           /* dosbox (qemu, bochs) */
                                   ;	
00000904  837EFA00              	cmp	word ptr [bp-6],0
00000908  741A                  	je	short @34@28
                                   ;	
                                   ;	            {
                                   ;	                enablePS2((handler_t)handlerRaton) ;
                                   ;	
0000090A  680000                	push	seg _handlerRaton
0000090D  68BE05                	push	offset _handlerRaton
00000910  E8B3FE                	call	near ptr _enablePS2
00000913  83C404                	add	sp,4
                                   ;	
                                   ;	                *isrRaton = isr_raton_dosbox ;
                                   ;	
00000916  8B5E06                	mov	bx,word ptr [bp+6]
00000919  C747020000            	mov	word ptr [bx+2],seg _isr_raton_dosbox
0000091E  C707BE01              	mov	word ptr [bx],offset _isr_raton_dosbox
                                   ;	
                                   ;	            }
                                   ;	
00000922  EB18                  	jmp	short @34@29
00000924                        @34@28:
                                   ;	
                                   ;	            else                                            /* qemu, bochs */
                                   ;	            {
                                   ;	                enablePS2((handler_t)handlerRatonNulo) ;
                                   ;	
00000924  680000                	push	seg _handlerRatonNulo
00000927  68BD05                	push	offset _handlerRatonNulo
0000092A  E899FE                	call	near ptr _enablePS2
0000092D  83C404                	add	sp,4
                                   ;	
                                   ;	                *isrRaton = isr_raton ;
                                   ;	
00000930  8B5E06                	mov	bx,word ptr [bp+6]
00000933  C747020000            	mov	word ptr [bx+2],seg _isr_raton
00000938  C707A201              	mov	word ptr [bx],offset _isr_raton
0000093C                        @34@29:
                                   ;	
                                   ;	            }
                                   ;	        }
                                   ;	
0000093C  EB16                  	jmp	short @34@33
0000093E                        @34@30:
                                   ;	
                                   ;	        else
                                   ;	        {
                                   ;	            if (conMensajes)
                                   ;	
0000093E  837E0800              	cmp	word ptr [bp+8],0
00000942  740A                  	je	short @34@32
                                   ;	
                                   ;	                printf("\r no se ha encontrado ningun raton \n") ;
                                   ;	
00000944  1E                    	push	ds
00000945  680F02                	push	offset DGROUP:s@+91
00000948  E80000                	call	near ptr _printf
0000094B  83C404                	add	sp,4
0000094E                        @34@32:
                                   ;	
                                   ;	            exit(-1) ;
                                   ;	
0000094E  6AFF                  	push	-1
00000950  E80000                	call	near ptr _exit
00000953  59                    	pop	cx
00000954                        @34@33:
                                   ;	
                                   ;	        }
                                   ;	    }
                                   ;	
                                   ;	    inicPC2c(&bloqueadosRaton, &e2BloqueadosRaton, maxProcesos + 0, FALSE) ;
                                   ;	
00000954  6A00                  	push	0
00000956  6A10                  	push	16
00000958  1E                    	push	ds
00000959  686000                	push	offset DGROUP:_e2BloqueadosRaton
0000095C  1E                    	push	ds
0000095D  685600                	push	offset DGROUP:_bloqueadosRaton
00000960  E80000                	call	near ptr _inicializarPC2c
00000963  83C40C                	add	sp,12
                                   ;	
                                   ;	}
                                   ;	
00000966  C9                    	leave	
00000967                        	ret	
00000968                        _inicRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000968                        _mostrarFormato	proc	near
                                   ;	
                                   ;	void mostrarFormato ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    printf(" formato: RATON [ [ -i | -q ] [ num ] | -u | -h ] ") ;
                                   ;	
00000968  1E                    	push	ds
00000969  683402                	push	offset DGROUP:s@+128
0000096C  E80000                	call	near ptr _printf
0000096F  83C404                	add	sp,4
                                   ;	
                                   ;	}
                                   ;	
00000972                        	ret	
00000973                        _mostrarFormato	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000973                        _formato	proc	near
                                   ;	
                                   ;	int formato ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    printf("\n\n") ;	
                                   ;	
00000973  1E                    	push	ds
00000974  686702                	push	offset DGROUP:s@+179
00000977  E80000                	call	near ptr _printf
0000097A  83C404                	add	sp,4
                                   ;	
                                   ;	    mostrarFormato() ;
                                   ;	
0000097D  E8E8FF                	call	near ptr _mostrarFormato
                                   ;	
                                   ;	    printf("\n") ;
                                   ;	
00000980  1E                    	push	ds
00000981  686A02                	push	offset DGROUP:s@+182
00000984  E80000                	call	near ptr _printf
00000987  83C404                	add	sp,4
                                   ;	
                                   ;	    return(-1) ;
                                   ;	
0000098A  B8FFFF                	mov	ax,-1
                                   ;	
                                   ;	}
                                   ;	
0000098D                        	ret	
0000098E                        _formato	endp
                                	assume	cs:_TEXT,ds:DGROUP
0000098E                        _help	proc	near
                                   ;	
                                   ;	int help ( void )
                                   ;	
                                   ;	
                                   ;	{
                                   ;	    printf("\n\n") ;
                                   ;	
0000098E  1E                    	push	ds
0000098F  686C02                	push	offset DGROUP:s@+184
00000992  E80000                	call	near ptr _printf
00000995  83C404                	add	sp,4
                                   ;	
                                   ;	    mostrarFormato() ;
                                   ;	
00000998  E8CDFF                	call	near ptr _mostrarFormato
                                   ;	
                                   ;	    printf(
                                   ;	
                                   ;	
                                   ;	        ""                                                               "\n"
                                   ;	        ""                                                               "\n"
                                   ;	        " instala/desinstala el driver del raton"                        "\n"
                                   ;	        ""                                                               "\n"
                                   ;	        " opciones: (por defecto -i)"                                    "\n"
                                   ;	        ""                                                               "\n"
                                   ;	        "      -i  : instala el driver (usar &)"                         "\n"
                                   ;	        "      -q  : instala sin mensajes de salida (&)"                 "\n"
                                   ;	        "      -u  : desintala el driver"                                "\n"
                                   ;	        "      -h  : muestra este help"                                  "\n"
                                   ;	    ) ;
                                   ;	
0000099B  1E                    	push	ds
0000099C  686F02                	push	offset DGROUP:s@+187
0000099F  E80000                	call	near ptr _printf
000009A2  83C404                	add	sp,4
                                   ;	
                                   ;	    return(0) ;
                                   ;	
000009A5  33C0                  	xor	ax,ax
                                   ;	
                                   ;	}
                                   ;	
000009A7                        	ret	
000009A8                        _help	endp
000009A8                        _TEXT	ends
0000019C                        _DATA	segment word public 'DATA'
0000019C                        _strTipoRaton	label	byte
0000019C  6E                    	db	110
0000019D  69                    	db	105
0000019E  6E                    	db	110
0000019F  67                    	db	103
000001A0  75                    	db	117
000001A1  6E                    	db	110
000001A2  6F                    	db	111
000001A3  00                    	db	1 dup (0)
000001A4  6D                    	db	109
000001A5  73                    	db	115
000001A6  64                    	db	100
000001A7  6F                    	db	111
000001A8  73                    	db	115
000001A9  000000                	db	3 dup (0)
000001AC  70                    	db	112
000001AD  73                    	db	115
000001AE  32                    	db	50
000001AF  0000000000            	db	5 dup (0)
000001B4                        _DATA	ends
000009A8                        _TEXT	segment byte public 'CODE'
                                	assume	cs:_TEXT,ds:DGROUP
000009A8                        _integrarRaton	proc	near
                                   ;	
                                   ;	int integrarRaton ( bool_t conMensajes )
                                   ;	
000009A8  C85E0000              	enter	94,0
                                   ;	
                                   ;	{
                                   ;	    int dfRaton ;
                                   ;	    dfs_t dfs ;
                                   ;	    descRecurso_t dR ;
                                   ;		
                                   ;	    int res ;                                                 /* resultado */
                                   ;	    pindx_t pindx ;
                                   ;		
                                   ;	    isr_t isrRaton ;                                 /* rutina de servicio */
                                   ;		
                                   ;	    rti_t rtiRecRatonOrg ;     /* rutina de tratamiento de la interrupcion */
                                   ;	
                                   ;	    rtiRatonOrg = ptrTVI[nVIntRaton] ;     /* antes de instalar el handler */
                                   ;	
000009AC  C41E0000              	les	bx,dword ptr DGROUP:_ptrTVI
000009B0  268B97D201            	mov	dx,word ptr es:[bx+466]
000009B5  268B87D001            	mov	ax,word ptr es:[bx+464]
000009BA  89160400              	mov	word ptr DGROUP:_rtiRatonOrg+2,dx
000009BE  A30200                	mov	word ptr DGROUP:_rtiRatonOrg,ax
                                   ;	
                                   ;	
                                   ;	#if (FALSE)                                             /* ya inicilizados */
                                   ;	    for ( pindx = 0 ; pindx < maxProcesos ; pindx++ )
                                   ;	    {
                                   ;	        nbytesProceso[pindx] = 0 ;          /* nbytes esperando ser leidos */
                                   ;	        dirProceso[pindx] = NULL ;               /* direcciones de destino */
                                   ;	    }	
                                   ;	#endif
                                   ;	
                                   ;	    inicRaton((tipoRaton_t *)&tipoRaton,
                                   ;	
                                   ;	
                                   ;	              (isr_t *)&isrRaton,
                                   ;	              (bool_t)conMensajes) ;               /* tipoRaton != ninguno */
                                   ;	
000009C1  FF7604                	push	word ptr [bp+4]
000009C4  8D46FA                	lea	ax,word ptr [bp-6]
000009C7  50                    	push	ax
000009C8  680600                	push	offset DGROUP:_tipoRaton
000009CB  E82CFE                	call	near ptr _inicRaton
000009CE  83C406                	add	sp,6
                                   ;	
                                   ;	
                                   ;	    dR.tipo = rDCaracteres ;
                                   ;	
000009D1  C746AE0100            	mov	word ptr [bp-82],1
                                   ;	
                                   ;	    strcpy(dR.nombre, "RATON") ;
                                   ;	
000009D6  1E                    	push	ds
000009D7  684C03                	push	offset DGROUP:s@+408
000009DA  16                    	push	ss
000009DB  8D46A2                	lea	ax,word ptr [bp-94]
000009DE  50                    	push	ax
000009DF  E80000                	call	near ptr _strcpy
000009E2  83C408                	add	sp,8
                                   ;	
                                   ;	    dR.ccb = (ccb_t)&descCcbRaton ;
                                   ;	
000009E5  8C5EB2                	mov	word ptr [bp-78],ds
000009E8  C746B06C01            	mov	word ptr [bp-80],offset DGROUP:_descCcbRaton
                                   ;	
                                   ;	    dR.ccb->arg = NULL ;
                                   ;	
000009ED  C45EB0                	les	bx,dword ptr [bp-80]
000009F0  26C7470A0000          	mov	word ptr es:[bx+10],0
000009F6  26C747080000          	mov	word ptr es:[bx+8],0
                                   ;	
                                   ;	    dR.pindx = getpindx() ;
                                   ;	
000009FC  E80000                	call	near ptr _getpindx
000009FF  8946B4                	mov	word ptr [bp-76],ax
                                   ;	
                                   ;	    dR.numVI = 1 ;
                                   ;	
00000A02  C646C001              	mov	byte ptr [bp-64],1
                                   ;	
                                   ;	    dR.nVInt[0] = nVIntRaton ;
                                   ;	
00000A06  C646C174              	mov	byte ptr [bp-63],116
                                   ;	
                                   ;	    dR.irq[0] = IRQ_RATON ;
                                   ;	
00000A0A  C646C30C              	mov	byte ptr [bp-61],12
                                   ;	
                                   ;	    dR.isr[0] = (isr_t)MK_FP(_CS, FP_OFF(isrRaton)) ;
                                   ;	
00000A0E  8CC8                  	mov	ax,cs
00000A10  33D2                  	xor	dx,dx
00000A12  0B56FA                	or	dx,word ptr [bp-6]
00000A15  8946C7                	mov	word ptr [bp-57],ax
00000A18  8956C5                	mov	word ptr [bp-59],dx
                                   ;	
                                   ;	
                                   ;	    dR.open      = (open_t)     MK_FP(_CS, FP_OFF(openRaton)) ;
                                   ;	
00000A1B  8CC8                  	mov	ax,cs
00000A1D  33D2                  	xor	dx,dx
00000A1F  81CAA100              	or	dx,offset _openRaton
00000A23  8946CF                	mov	word ptr [bp-49],ax
00000A26  8956CD                	mov	word ptr [bp-51],dx
                                   ;	
                                   ;	    dR.release   = (release_t)  MK_FP(_CS, FP_OFF(releaseRaton)) ;
                                   ;	
00000A29  8CC8                  	mov	ax,cs
00000A2B  33D2                  	xor	dx,dx
00000A2D  81CAA400              	or	dx,offset _releaseRaton
00000A31  8946D3                	mov	word ptr [bp-45],ax
00000A34  8956D1                	mov	word ptr [bp-47],dx
                                   ;	
                                   ;	    dR.read      = (read_t)     MK_FP(_CS, FP_OFF(readRaton)) ;
                                   ;	
00000A37  8CC8                  	mov	ax,cs
00000A39  33D2                  	xor	dx,dx
00000A3B  81CAA700              	or	dx,offset _readRaton
00000A3F  8946D7                	mov	word ptr [bp-41],ax
00000A42  8956D5                	mov	word ptr [bp-43],dx
                                   ;	
                                   ;	    dR.aio_read  = (aio_read_t) MK_FP(_CS, FP_OFF(aio_readRaton)) ;
                                   ;	
00000A45  8CC8                  	mov	ax,cs
00000A47  33D2                  	xor	dx,dx
00000A49  81CA2201              	or	dx,offset _aio_readRaton
00000A4D  8946DB                	mov	word ptr [bp-37],ax
00000A50  8956D9                	mov	word ptr [bp-39],dx
                                   ;	
                                   ;	    dR.write     = (write_t)    MK_FP(_CS, FP_OFF(writeRaton)) ;
                                   ;	
00000A53  8CC8                  	mov	ax,cs
00000A55  33D2                  	xor	dx,dx
00000A57  81CA5D01              	or	dx,offset _writeRaton
00000A5B  8946DF                	mov	word ptr [bp-33],ax
00000A5E  8956DD                	mov	word ptr [bp-35],dx
                                   ;	
                                   ;	    dR.aio_write = (aio_write_t)MK_FP(_CS, FP_OFF(aio_writeRaton)) ;
                                   ;	
00000A61  8CC8                  	mov	ax,cs
00000A63  33D2                  	xor	dx,dx
00000A65  81CA6001              	or	dx,offset _aio_writeRaton
00000A69  8946E3                	mov	word ptr [bp-29],ax
00000A6C  8956E1                	mov	word ptr [bp-31],dx
                                   ;	
                                   ;	    dR.lseek     = (lseek_t)    MK_FP(_CS, FP_OFF(lseekRaton)) ;
                                   ;	
00000A6F  8CC8                  	mov	ax,cs
00000A71  33D2                  	xor	dx,dx
00000A73  81CA6301              	or	dx,offset _lseekRaton
00000A77  8946E7                	mov	word ptr [bp-25],ax
00000A7A  8956E5                	mov	word ptr [bp-27],dx
                                   ;	
                                   ;	    dR.fcntl     = (fcntl_t)    MK_FP(_CS, FP_OFF(fcntlRaton)) ;
                                   ;	
00000A7D  8CC8                  	mov	ax,cs
00000A7F  33D2                  	xor	dx,dx
00000A81  81CA6A01              	or	dx,offset _fcntlRaton
00000A85  8946EB                	mov	word ptr [bp-21],ax
00000A88  8956E9                	mov	word ptr [bp-23],dx
                                   ;	
                                   ;	    dR.ioctl     = (ioctl_t)    MK_FP(_CS, FP_OFF(ioctlRaton)) ;
                                   ;	
00000A8B  8CC8                  	mov	ax,cs
00000A8D  33D2                  	xor	dx,dx
00000A8F  81CA6D01              	or	dx,offset _ioctlRaton
00000A93  8946EF                	mov	word ptr [bp-17],ax
00000A96  8956ED                	mov	word ptr [bp-19],dx
                                   ;	
                                   ;	
                                   ;	    dR.eliminar  = (eliminar_t) MK_FP(_CS, FP_OFF(eliminarRaton)) ;
                                   ;	
00000A99  8CC8                  	mov	ax,cs
00000A9B  33D2                  	xor	dx,dx
00000A9D  81CA7001              	or	dx,offset _eliminarRaton
00000AA1  8946F3                	mov	word ptr [bp-13],ax
00000AA4  8956F1                	mov	word ptr [bp-15],dx
                                   ;	
                                   ;	
                                   ;	    asm pushf
                                   ;	
00000AA7  9C                     	pushf	
                                   ;	
                                   ;	    asm cli
                                   ;	
00000AA8  FA                     	cli	
                                   ;	
                                   ;	
                                   ;	    rtiRecRatonOrg = ptrTVI[nVIntRaton] ;      /* tras instalar el handler */
                                   ;	
00000AA9  C41E0000              	les	bx,dword ptr DGROUP:_ptrTVI
00000AAD  268B97D201            	mov	dx,word ptr es:[bx+466]
00000AB2  268B87D001            	mov	ax,word ptr es:[bx+464]
00000AB7  8956F8                	mov	word ptr [bp-8],dx
00000ABA  8946F6                	mov	word ptr [bp-10],ax
                                   ;	
                                   ;	    rec_raton = crearRecurso(&dR) ;
                                   ;	
00000ABD  16                    	push	ss
00000ABE  8D46A2                	lea	ax,word ptr [bp-94]
00000AC1  50                    	push	ax
00000AC2  E80000                	call	near ptr _crearRecurso
00000AC5  83C404                	add	sp,4
00000AC8  A35400                	mov	word ptr DGROUP:_rec_raton,ax
                                   ;	
                                   ;	    if (tipoRaton == msdos)
                                   ;	
00000ACB  833E060001            	cmp	word ptr DGROUP:_tipoRaton,1
00000AD0  7537                  	jne	short @38@6
                                   ;	
                                   ;	    {
                                   ;	        rti_nVIntRaton = ptrTVI[nVIntRaton] ;        /* ver so1\interrup.c */
                                   ;	
00000AD2  C41E0000              	les	bx,dword ptr DGROUP:_ptrTVI
00000AD6  268B97D201            	mov	dx,word ptr es:[bx+466]
00000ADB  268B87D001            	mov	ax,word ptr es:[bx+464]
00000AE0  89165601              	mov	word ptr DGROUP:_rti_nVIntRaton+2,dx
00000AE4  A35401                	mov	word ptr DGROUP:_rti_nVIntRaton,ax
                                   ;	
                                   ;	        segment_rti_nVIntRaton = FP_SEG(rti_nVIntRaton) ;
                                   ;	
00000AE7  8B165601              	mov	dx,word ptr DGROUP:_rti_nVIntRaton+2
00000AEB  89165801              	mov	word ptr DGROUP:_segment_rti_nVIntRaton,dx
                                   ;	
                                   ;	        offset_rti_nVIntRaton = FP_OFF(rti_nVIntRaton) ;
                                   ;	
00000AEF  A15401                	mov	ax,word ptr DGROUP:_rti_nVIntRaton
00000AF2  A35A01                	mov	word ptr DGROUP:_offset_rti_nVIntRaton,ax
                                   ;	
                                   ;	        ptrTVI[nVIntRaton] = rtiRecRatonOrg ; /* restablecer el v.i.nVIntRaton */
                                   ;	
00000AF5  C41E0000              	les	bx,dword ptr DGROUP:_ptrTVI
00000AF9  8B56F8                	mov	dx,word ptr [bp-8]
00000AFC  8B46F6                	mov	ax,word ptr [bp-10]
00000AFF  268997D201            	mov	word ptr es:[bx+466],dx
00000B04  268987D001            	mov	word ptr es:[bx+464],ax
00000B09                        @38@6:
                                   ;	
                                   ;	    }
                                   ;		
                                   ;	    asm popf
                                   ;	
00000B09  9D                     	popf	
                                   ;	
                                   ;	
                                   ;	    if (rec_raton >= 0)
                                   ;	
00000B0A  833E540000            	cmp	word ptr DGROUP:_rec_raton,0
00000B0F  7D02                  	jge	@@7
00000B11  EB77                  	jmp	@38@22
00000B13                        @@7:
                                   ;	
                                   ;	    {
                                   ;	        dfs = crearFichero("RATON", rec_raton, 0, fedCaracteres) ;
                                   ;	
00000B13  6A03                  	push	3
00000B15  6A00                  	push	0
00000B17  FF365400              	push	word ptr DGROUP:_rec_raton
00000B1B  1E                    	push	ds
00000B1C  685203                	push	offset DGROUP:s@+414
00000B1F  E80000                	call	near ptr _crearFichero
00000B22  83C40A                	add	sp,10
00000B25  8946FE                	mov	word ptr [bp-2],ax
                                   ;	
                                   ;	
                                   ;	        if (dfs < 0)
                                   ;	
00000B28  837EFE00              	cmp	word ptr [bp-2],0
00000B2C  7D3E                  	jge	short @38@19
                                   ;	
                                   ;	        {
                                   ;	            switch(dfs)
                                   ;	
00000B2E  8B5EFE                	mov	bx,word ptr [bp-2]
00000B31  83EBFC                	sub	bx,-4
00000B34  83FB03                	cmp	bx,3
00000B37  771F                  	ja	short @38@16
00000B39  03DB                  	add	bx,bx
00000B3B  2EFFA7E80B            	jmp	word ptr cs:@38@C92[bx]
00000B40                        @38@12:
                                   ;	
                                   ;	            {
                                   ;	            case -1 : printf(" tipo de fichero erroneo") ; break ;
                                   ;	
00000B40  1E                    	push	ds
00000B41  685803                	push	offset DGROUP:s@+420
00000B44  EB16                  	jmp	short @38@17
00000B46                        @38@13:
                                   ;	
                                   ;	            case -2 : printf(" numero de recurso erroneo") ; break ;
                                   ;	
00000B46  1E                    	push	ds
00000B47  687103                	push	offset DGROUP:s@+445
00000B4A  EB10                  	jmp	short @38@17
00000B4C                        @38@14:
                                   ;	
                                   ;	            case -3 : printf(" RATON nombre de fichero ya existente") ; break ;
                                   ;	
00000B4C  1E                    	push	ds
00000B4D  688C03                	push	offset DGROUP:s@+472
00000B50  EB0A                  	jmp	short @38@17
00000B52                        @38@15:
                                   ;	
                                   ;	            case -4 : printf(" no hay descriptores de fichero libres") ; break ;
                                   ;	
00000B52  1E                    	push	ds
00000B53  68B203                	push	offset DGROUP:s@+510
00000B56  EB04                  	jmp	short @38@17
00000B58                        @38@16:
                                   ;	
                                   ;	            default : printf(" no ha podido crearse el fichero RATON") ;
                                   ;	
00000B58  1E                    	push	ds
00000B59  68D903                	push	offset DGROUP:s@+549
00000B5C                        @38@17:
00000B5C  E80000                	call	near ptr _printf
00000B5F  83C404                	add	sp,4
                                   ;	
                                   ;	            }
                                   ;	            destruirRecurso("RATON") ;
                                   ;	
00000B62  1E                    	push	ds
00000B63  680004                	push	offset DGROUP:s@+588
00000B66  E80000                	call	near ptr _destruirRecurso
00000B69  83C404                	add	sp,4
00000B6C                        @38@19:
                                   ;	
                                   ;	        }
                                   ;	        if (conMensajes)
                                   ;	
00000B6C  837E0400              	cmp	word ptr [bp+4],0
00000B70  7414                  	je	short @38@21
                                   ;	
                                   ;	            printf(
                                   ;	
                                   ;	
                                   ;	                ""                                                       "\n"
                                   ;	                ""                                                       "\n"
                                   ;	                " recurso RATON instalado (fichero: RATON)"              "\n"
                                   ;	                ""                                                       "\n"
                                   ;	                " tipo de raton = %s\n", 
                                   ;					strTipoRaton[tipoRaton]
                                   ;	            ) ;
                                   ;	
00000B72  A10600                	mov	ax,word ptr DGROUP:_tipoRaton
00000B75  C1E003                	shl	ax,3
00000B78  059C01                	add	ax,offset DGROUP:_strTipoRaton
00000B7B  50                    	push	ax
00000B7C  1E                    	push	ds
00000B7D  680604                	push	offset DGROUP:s@+594
00000B80  E80000                	call	near ptr _printf
00000B83  83C406                	add	sp,6
00000B86                        @38@21:
                                   ;	
                                   ;	        return(0) ;
                                   ;	
00000B86  33C0                  	xor	ax,ax
00000B88  C9                    	leave	
00000B89                        	ret	
00000B8A                        @38@22:
                                   ;	
                                   ;	    }
                                   ;	
                                   ;	    printf("\n\n") ;
                                   ;	
00000B8A  1E                    	push	ds
00000B8B  684804                	push	offset DGROUP:s@+660
00000B8E  E80000                	call	near ptr _printf
00000B91  83C404                	add	sp,4
                                   ;	
                                   ;	    switch(rec_raton)
                                   ;	
00000B94  8B1E5400              	mov	bx,word ptr DGROUP:_rec_raton
00000B98  83EBFB                	sub	bx,-5
00000B9B  83FB04                	cmp	bx,4
00000B9E  7725                  	ja	short @38@31
00000BA0  03DB                  	add	bx,bx
00000BA2  2EFFA7DE0B            	jmp	word ptr cs:@38@C97[bx]
00000BA7                        @38@26:
                                   ;	
                                   ;	    {
                                   ;	    case -1 : printf(" tipo de recurso erroneo ") ; break ;
                                   ;	
00000BA7  1E                    	push	ds
00000BA8  684B04                	push	offset DGROUP:s@+663
00000BAB  EB1C                  	jmp	short @38@32
00000BAD                        @38@27:
                                   ;	
                                   ;	    case -2 : printf(" demasiados vectores de interrupcion ") ; break ;
                                   ;	
00000BAD  1E                    	push	ds
00000BAE  686504                	push	offset DGROUP:s@+689
00000BB1  EB16                  	jmp	short @38@32
00000BB3                        @38@28:
                                   ;	
                                   ;	    case -3 : printf(" RATON nombre de recurso ya existente ") ; break ;
                                   ;	
00000BB3  1E                    	push	ds
00000BB4  688B04                	push	offset DGROUP:s@+727
00000BB7  EB10                  	jmp	short @38@32
00000BB9                        @38@29:
                                   ;	
                                   ;	    case -4 : printf(" no hay descriptores de recurso libres ") ; break ;
                                   ;	
00000BB9  1E                    	push	ds
00000BBA  68B204                	push	offset DGROUP:s@+766
00000BBD  EB0A                  	jmp	short @38@32
00000BBF                        @38@30:
                                   ;	
                                   ;	    case -5 : printf(" numero de vector de interrupcion ya usado ") ; break ;
                                   ;	
00000BBF  1E                    	push	ds
00000BC0  68DA04                	push	offset DGROUP:s@+806
00000BC3  EB04                  	jmp	short @38@32
00000BC5                        @38@31:
                                   ;	
                                   ;	    default : printf(" no ha podido crearse el recurso RATON ") ;
                                   ;	
00000BC5  1E                    	push	ds
00000BC6  680605                	push	offset DGROUP:s@+850
00000BC9                        @38@32:
00000BC9  E80000                	call	near ptr _printf
00000BCC  83C404                	add	sp,4
                                   ;	
                                   ;	    }
                                   ;	    printf("\n") ;
                                   ;	
00000BCF  1E                    	push	ds
00000BD0  682E05                	push	offset DGROUP:s@+890
00000BD3  E80000                	call	near ptr _printf
00000BD6  83C404                	add	sp,4
                                   ;	
                                   ;	    return(-1) ;
                                   ;	
00000BD9  B8FFFF                	mov	ax,-1
                                   ;	
                                   ;	}
                                   ;	
00000BDC  C9                    	leave	
00000BDD                        	ret	
00000BDE                        _integrarRaton	endp
00000BDE                        @38@C97	label	word
00000BDE  BF0B                  	dw	@38@30
00000BE0  B90B                  	dw	@38@29
00000BE2  B30B                  	dw	@38@28
00000BE4  AD0B                  	dw	@38@27
00000BE6  A70B                  	dw	@38@26
00000BE8                        @38@C92	label	word
00000BE8  520B                  	dw	@38@15
00000BEA  4C0B                  	dw	@38@14
00000BEC  460B                  	dw	@38@13
00000BEE  400B                  	dw	@38@12
                                	assume	cs:_TEXT,ds:DGROUP
00000BF0                        _desintegrarRaton	proc	near
                                   ;	
                                   ;	int desintegrarRaton ( void )
                                   ;	
00000BF0  C8020000              	enter	2,0
                                   ;	
                                   ;	{
                                   ;	    int res ;
                                   ;	    res = 0 ;
                                   ;	
00000BF4  C746FE0000            	mov	word ptr [bp-2],0
                                   ;	
                                   ;	    switch (tipoRaton)
                                   ;	
00000BF9  A10600                	mov	ax,word ptr DGROUP:_tipoRaton
00000BFC  83F801                	cmp	ax,1
00000BFF  7407                  	je	short @39@6
00000C01  83F802                	cmp	ax,2
00000C04  7410                  	je	short @39@7
00000C06  EB11                  	jmp	short @39@8
00000C08                        @39@6:
                                   ;	
                                   ;	    {
                                   ;	    case msdos :
                                   ;	        uninstallMouseEventHandler(ratonHandler) ;
                                   ;	
00000C08  680000                	push	seg _ratonHandler
00000C0B  684202                	push	offset _ratonHandler
00000C0E  E80000                	call	near ptr _uninstallMouseEventHandler
00000C11  83C404                	add	sp,4
                                   ;	
                                   ;	        break ;
                                   ;	
00000C14  EB03                  	jmp	short @39@8
00000C16                        @39@7:
                                   ;	
                                   ;	    case ps2   :
                                   ;	        disablePS2() ;
                                   ;	
00000C16  E886FB                	call	near ptr _disablePS2
00000C19                        @39@8:
                                   ;	
                                   ;	    }
                                   ;	    return(res) ;
                                   ;	
00000C19  8B46FE                	mov	ax,word ptr [bp-2]
                                   ;	
                                   ;	}
                                   ;	
00000C1C  C9                    	leave	
00000C1D                        	ret	
00000C1E                        _desintegrarRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000C1E                        _instalarRaton	proc	near
                                   ;	
                                   ;	int instalarRaton ( bool_t conMensajes )
                                   ;	
00000C1E  C8020000              	enter	2,0
                                   ;	
                                   ;	{
                                   ;	    int res ;
                                   ;	    res = comprobarAmpersand() ;
                                   ;	
00000C22  E80000                	call	near ptr _comprobarAmpersand
00000C25  8946FE                	mov	word ptr [bp-2],ax
                                   ;	
                                   ;	    if (res != 0) return(res) ;
                                   ;	
00000C28  837EFE00              	cmp	word ptr [bp-2],0
00000C2C  7402                  	je	short @40@3
00000C2E  EB35                  	jmp	short @40@6
00000C30                        @40@3:
                                   ;	
                                   ;	    obtenInfoSO1(dirDescSO1) ;               /* obtenemos los datos de SO1 */
                                   ;	
00000C30  1E                    	push	ds
00000C31  680000                	push	offset DGROUP:_ptrIndProcesoActual
00000C34  E80000                	call	near ptr _obtenInfoSO1
00000C37  83C404                	add	sp,4
                                   ;	
                                   ;	    res = integrarRaton(conMensajes) ;
                                   ;	
00000C3A  FF7604                	push	word ptr [bp+4]
00000C3D  E868FD                	call	near ptr _integrarRaton
00000C40  59                    	pop	cx
00000C41  8946FE                	mov	word ptr [bp-2],ax
                                   ;	
                                   ;	    if (res != 0) return(res) ;
                                   ;	
00000C44  837EFE00              	cmp	word ptr [bp-2],0
00000C48  7402                  	je	short @40@5
00000C4A  EB19                  	jmp	short @40@6
00000C4C                        @40@5:
                                   ;	
                                   ;	#if (!REDUCIR_DRIVER)
                                   ;	    esperarDesinstalacion(0) ;                       /* bloquea el proceso */
                                   ;	#else
                                   ;	    esperarDesinstalacion(                           /* bloquea el proceso */
                                   ;	
                                   ;	
                                   ;	//      FP_OFF(dirDescSO1) + sizeof(descSO1_t)
                                   ;	//          ...
                                   ;	//          + sizeof(descCcbConsola) + 0*sizeof(callBack_t),    /* tamDATA */
                                   ;	        FP_OFF(&descCcbRaton)
                                   ;	            + sizeof(descCcbRaton) + 9*sizeof(callBack_t),      /* tamDATA */
                                   ;	        FP_OFF(finCodeDriver),                            /* finCodeDriver */
                                   ;	        FP_OFF(finishRaton)                                /* finishDriver */
                                   ;	    ) ;
                                   ;	
00000C4C  687C06                	push	offset _finishRaton
00000C4F  688506                	push	offset _finCodeDriver
00000C52  B86C01                	mov	ax,offset DGROUP:_descCcbRaton
00000C55  83C030                	add	ax,48
00000C58  50                    	push	ax
00000C59  E80000                	call	near ptr _esperarDesinstalacion
00000C5C  83C406                	add	sp,6
                                   ;	
                                   ;	#endif
                                   ;	    res = desintegrarRaton() ;
                                   ;	
00000C5F  E88EFF                	call	near ptr _desintegrarRaton
00000C62  8946FE                	mov	word ptr [bp-2],ax
00000C65                        @40@6:
                                   ;	
                                   ;	    return(res) ;
                                   ;	
00000C65  8B46FE                	mov	ax,word ptr [bp-2]
                                   ;	
                                   ;	}
                                   ;	
00000C68  C9                    	leave	
00000C69                        	ret	
00000C6A                        _instalarRaton	endp
                                	assume	cs:_TEXT,ds:DGROUP
00000C6A                        _main	proc	near
                                   ;	
                                   ;	int main ( int argc, char * argv [ ] )
                                   ;	
00000C6A  C8020000              	enter	2,0
                                   ;	
                                   ;	{
                                   ;	    int res ;
                                   ;	    if (argc > 3) return(formato()) ;
                                   ;	
00000C6E  837E0403              	cmp	word ptr [bp+4],3
00000C72  7E06                  	jle	short @41@4
00000C74  E95C01                	jmp	@41@43
00000C77  E9C600                	jmp	@41@30
00000C7A                        @41@4:
                                   ;	
                                   ;	    else if (argc == 1) return(instalarRaton(TRUE)) ;
                                   ;	
00000C7A  837E0401              	cmp	word ptr [bp+4],1
00000C7E  7505                  	jne	short @41@7
00000C80  EB3E                  	jmp	short @41@12
00000C82  E9BB00                	jmp	@41@30
00000C85                        @41@7:
                                   ;	
                                   ;	    else if (argc == 2)
                                   ;	
00000C85  837E0402              	cmp	word ptr [bp+4],2
00000C89  7403                  	je	@@8
00000C8B  E9B200                	jmp	@41@30
00000C8E                        @@8:
                                   ;	
                                   ;	    {
                                   ;	        if (!strcmpu(argv[1], "-h")) return(help()) ;
                                   ;	
00000C8E  1E                    	push	ds
00000C8F  683005                	push	offset DGROUP:s@+892
00000C92  1E                    	push	ds
00000C93  8B5E06                	mov	bx,word ptr [bp+6]
00000C96  FF7702                	push	word ptr [bx+2]
00000C99  E80000                	call	near ptr _strcmpu
00000C9C  83C408                	add	sp,8
00000C9F  0BC0                  	or	ax,ax
00000CA1  7508                  	jne	short @41@11
00000CA3  E8E8FC                	call	near ptr _help
00000CA6  C9                    	leave	
00000CA7                        	ret	
00000CA8  E99500                	jmp	@41@30
00000CAB                        @41@11:
                                   ;	
                                   ;	        else if (!strcmpu(argv[1], "-i")) return(instalarRaton(TRUE)) ;
                                   ;	
00000CAB  1E                    	push	ds
00000CAC  683305                	push	offset DGROUP:s@+895
00000CAF  1E                    	push	ds
00000CB0  8B5E06                	mov	bx,word ptr [bp+6]
00000CB3  FF7702                	push	word ptr [bx+2]
00000CB6  E80000                	call	near ptr _strcmpu
00000CB9  83C408                	add	sp,8
00000CBC  0BC0                  	or	ax,ax
00000CBE  7506                  	jne	short @41@14
00000CC0                        @41@12:
00000CC0  6A01                  	push	1
00000CC2  EB19                  	jmp	short @41@16
00000CC4  EB7A                  	jmp	@41@30
00000CC6                        @41@14:
                                   ;	
                                   ;	        else if (!strcmpu(argv[1], "-q")) return(instalarRaton(FALSE)) ;
                                   ;	
00000CC6  1E                    	push	ds
00000CC7  683605                	push	offset DGROUP:s@+898
00000CCA  1E                    	push	ds
00000CCB  8B5E06                	mov	bx,word ptr [bp+6]
00000CCE  FF7702                	push	word ptr [bx+2]
00000CD1  E80000                	call	near ptr _strcmpu
00000CD4  83C408                	add	sp,8
00000CD7  0BC0                  	or	ax,ax
00000CD9  750A                  	jne	short @41@18
00000CDB  6A00                  	push	0
00000CDD                        @41@16:
00000CDD  E83EFF                	call	near ptr _instalarRaton
00000CE0  59                    	pop	cx
00000CE1  C9                    	leave	
00000CE2                        	ret	
00000CE3  EB5B                  	jmp	short @41@30
00000CE5                        @41@18:
                                   ;	
                                   ;	        else if (!strcmpu(argv[1], "-u"))
                                   ;	
00000CE5  1E                    	push	ds
00000CE6  683905                	push	offset DGROUP:s@+901
00000CE9  1E                    	push	ds
00000CEA  8B5E06                	mov	bx,word ptr [bp+6]
00000CED  FF7702                	push	word ptr [bx+2]
00000CF0  E80000                	call	near ptr _strcmpu
00000CF3  83C408                	add	sp,8
00000CF6  0BC0                  	or	ax,ax
00000CF8  7546                  	jne	short @41@30
                                   ;	
                                   ;	        {
                                   ;	            res = destruirRecurso("RATON") ;
                                   ;	
00000CFA  1E                    	push	ds
00000CFB  683C05                	push	offset DGROUP:s@+904
00000CFE  E80000                	call	near ptr _destruirRecurso
00000D01  83C404                	add	sp,4
00000D04  8946FE                	mov	word ptr [bp-2],ax
                                   ;	
                                   ;	            switch (res)
                                   ;	
00000D07  8B5EFE                	mov	bx,word ptr [bp-2]
00000D0A  83EBFD                	sub	bx,-3
00000D0D  83FB03                	cmp	bx,3
00000D10  771F                  	ja	short @41@27
00000D12  03DB                  	add	bx,bx
00000D14  2EFFA7D80D            	jmp	word ptr cs:@41@C97[bx]
00000D19                        @41@23:
                                   ;	
                                   ;	            {
                                   ;	            case  0 : printf(" recurso RATON desinstalado") ; break ;
                                   ;	
00000D19  1E                    	push	ds
00000D1A  684205                	push	offset DGROUP:s@+910
00000D1D  EB16                  	jmp	short @41@28
00000D1F                        @41@24:
                                   ;	
                                   ;	            case -1 : printf(" recurso RATON no existe") ; break ;
                                   ;	
00000D1F  1E                    	push	ds
00000D20  685E05                	push	offset DGROUP:s@+938
00000D23  EB10                  	jmp	short @41@28
00000D25                        @41@25:
                                   ;	
                                   ;	            case -2 : printf(" recurso RATON en uso") ; break ;
                                   ;	
00000D25  1E                    	push	ds
00000D26  687705                	push	offset DGROUP:s@+963
00000D29  EB0A                  	jmp	short @41@28
00000D2B                        @41@26:
                                   ;	
                                   ;	            case -3 : printf(" fichero RATON no puede destruirse") ; break ;
                                   ;	
00000D2B  1E                    	push	ds
00000D2C  688D05                	push	offset DGROUP:s@+985
00000D2F  EB04                  	jmp	short @41@28
00000D31                        @41@27:
                                   ;	
                                   ;	            default : printf(" RATON no ha podido desinstalarse") ;
                                   ;	
00000D31  1E                    	push	ds
00000D32  68B005                	push	offset DGROUP:s@+1020
00000D35                        @41@28:
00000D35  E80000                	call	near ptr _printf
00000D38  83C404                	add	sp,4
                                   ;	
                                   ;	            }
                                   ;	            return(res) ;
                                   ;	
00000D3B  8B46FE                	mov	ax,word ptr [bp-2]
00000D3E  C9                    	leave	
00000D3F                        	ret	
00000D40                        @41@30:
                                   ;	
                                   ;	        }
                                   ;	    }
                                   ;	    if ((argc == 2) ||
                                   ;	
                                   ;	
                                   ;	            ((argc == 3) &&
                                   ;	             (!strcmpu(argv[1], "-i") ||
                                   ;	              !strcmpu(argv[1], "-q"))
                                   ;	            )
                                   ;	       )
                                   ;	
00000D40  837E0402              	cmp	word ptr [bp+4],2
00000D44  7433                  	je	short @41@34
00000D46  837E0403              	cmp	word ptr [bp+4],3
00000D4A  7403                  	je	@@9
00000D4C  E98400                	jmp	@41@43
00000D4F                        @@9:
00000D4F  1E                    	push	ds
00000D50  68D205                	push	offset DGROUP:s@+1054
00000D53  1E                    	push	ds
00000D54  8B5E06                	mov	bx,word ptr [bp+6]
00000D57  FF7702                	push	word ptr [bx+2]
00000D5A  E80000                	call	near ptr _strcmpu
00000D5D  83C408                	add	sp,8
00000D60  0BC0                  	or	ax,ax
00000D62  7415                  	je	short @41@34
00000D64  1E                    	push	ds
00000D65  68D505                	push	offset DGROUP:s@+1057
00000D68  1E                    	push	ds
00000D69  8B5E06                	mov	bx,word ptr [bp+6]
00000D6C  FF7702                	push	word ptr [bx+2]
00000D6F  E80000                	call	near ptr _strcmpu
00000D72  83C408                	add	sp,8
00000D75  0BC0                  	or	ax,ax
00000D77  755A                  	jne	short @41@43
00000D79                        @41@34:
                                   ;	
                                   ;	    {
                                   ;	        strcpy(comando[0], argv[argc-1]) ;
                                   ;	
00000D79  1E                    	push	ds
00000D7A  8B5E04                	mov	bx,word ptr [bp+4]
00000D7D  4B                    	dec	bx
00000D7E  03DB                  	add	bx,bx
00000D80  035E06                	add	bx,word ptr [bp+6]
00000D83  FF37                  	push	word ptr [bx]
00000D85  1E                    	push	ds
00000D86  680000                	push	offset DGROUP:_comando
00000D89  E80000                	call	near ptr _strcpy
00000D8C  83C408                	add	sp,8
                                   ;	
                                   ;	        inicScanner() ;
                                   ;	
00000D8F  E80000                	call	near ptr _inicScanner
                                   ;	
                                   ;	        obtenSimb() ;
                                   ;	
00000D92  E80000                	call	near ptr _obtenSimb
                                   ;	
                                   ;	        if (simb == s_numero)
                                   ;	
00000D95  833E000013            	cmp	word ptr DGROUP:_simb,19
00000D9A  7537                  	jne	short @41@43
                                   ;	
                                   ;	        {
                                   ;	            if (num == 0)
                                   ;	
00000D9C  833E000000            	cmp	word ptr DGROUP:_num,0
00000DA1  7511                  	jne	short @41@39
                                   ;	
                                   ;	            {
                                   ;	                printf("\n\n numConsolas debe ser > 0 \n") ;
                                   ;	
00000DA3  1E                    	push	ds
00000DA4  68D805                	push	offset DGROUP:s@+1060
00000DA7  E80000                	call	near ptr _printf
00000DAA  83C404                	add	sp,4
                                   ;	
                                   ;	                return(-1) ;
                                   ;	
00000DAD  B8FFFF                	mov	ax,-1
00000DB0  C9                    	leave	
00000DB1                        	ret	
                                   ;	
                                   ;	            }
                                   ;	
00000DB2  EB1F                  	jmp	short @41@43
00000DB4                        @41@39:
                                   ;	
                                   ;	            else return(instalarRaton(toupper(argv[1][1]) == 'Q')) ;
                                   ;	
00000DB4  8B5E06                	mov	bx,word ptr [bp+6]
00000DB7  8B5F02                	mov	bx,word ptr [bx+2]
00000DBA  8A4701                	mov	al,byte ptr [bx+1]
00000DBD  98                    	cbw	
00000DBE  50                    	push	ax
00000DBF  E80000                	call	near ptr _toupper
00000DC2  59                    	pop	cx
00000DC3  83F851                	cmp	ax,81
00000DC6  7505                  	jne	short @41@41
00000DC8  B80100                	mov	ax,1
00000DCB  EB02                  	jmp	short @41@42
00000DCD                        @41@41:
00000DCD  33C0                  	xor	ax,ax
00000DCF                        @41@42:
00000DCF  50                    	push	ax
00000DD0  E90AFF                	jmp	@41@16
00000DD3                        @41@43:
                                   ;	
                                   ;	        }
                                   ;	    }
                                   ;	    return(formato()) ;
                                   ;	
00000DD3  E89DFB                	call	near ptr _formato
                                   ;	
                                   ;	}
                                   ;	
00000DD6  C9                    	leave	
00000DD7                        	ret	
00000DD8                        _main	endp
00000DD8                        @41@C97	label	word
00000DD8  2B0D                  	dw	@41@26
00000DDA  250D                  	dw	@41@25
00000DDC  1F0D                  	dw	@41@24
00000DDE  190D                  	dw	@41@23
00000DE0                        _TEXT	ends
00000002                        _BSS	segment word public 'BSS'
00000002                        _rtiRatonOrg	label	dword
00000002  00000000              	db	4 dup (?)
00000006                        _tipoRaton	label	word
00000006  0000                  	db	2 dup (?)
00000008                        _BSS	ends
000001B4                        _DATA	segment word public 'DATA'
000001B4                        s@	label	byte
000001B4  30312F30312F3932      	db	'01/01/92'
000001BC  00                    	db	0
000001BD  0A                    	db	10
000001BE  0A                    	db	10
000001BF  206861794E5420        	db	' hayNT '
000001C6  00                    	db	0
000001C7  0A                    	db	10
000001C8  0A                    	db	10
000001C9  2068617944426F7820    	db	' hayDBox '
000001D2  00                    	db	0
000001D3  0A                    	db	10
000001D4  0A                    	db	10
000001D5  206E6F206861792072    	db	' no hay raton BIOS '
000001E8  00                    	db	0
000001E9  0A                    	db	10
000001EA  0A                    	db	10
000001EB  20636F6D70726F6261    	db	' comprobando si hay raton PS/2 '
0000020A  00                    	db	0
0000020B  204F6B                	db	' Ok'
0000020E  00                    	db	0
0000020F  0D                    	db	13
00000210  206E6F207365206861    	db	' no se ha encontrado ningun raton '
00000232  0A                    	db	10
00000233  00                    	db	0
00000234  20666F726D61746F3A    	db	' formato: RATON [ [ -i | -q ] [ num ] | -u | -h ] '
00000266  00                    	db	0
00000267  0A                    	db	10
00000268  0A                    	db	10
00000269  00                    	db	0
0000026A  0A                    	db	10
0000026B  00                    	db	0
0000026C  0A                    	db	10
0000026D  0A                    	db	10
0000026E  00                    	db	0
0000026F  0A                    	db	10
00000270  0A                    	db	10
00000271  20696E7374616C612F    	db	' instala/desinstala el driver del raton'
00000298  0A                    	db	10
00000299  0A                    	db	10
0000029A  206F7063696F6E6573    	db	' opciones: (por defecto -i)'
000002B5  0A                    	db	10
000002B6  0A                    	db	10
000002B7  2020202020202D6920    	db	'      -i  : instala el driver (usar &)'
000002DD  0A                    	db	10
000002DE  2020202020202D7120    	db	'      -q  : instala sin mensajes de salida (&)'
0000030C  0A                    	db	10
0000030D  2020202020202D7520    	db	'      -u  : desintala el driver'
0000032C  0A                    	db	10
0000032D  2020202020202D6820    	db	'      -h  : muestra este help'
0000034A  0A                    	db	10
0000034B  00                    	db	0
0000034C  5241544F4E            	db	'RATON'
00000351  00                    	db	0
00000352  5241544F4E            	db	'RATON'
00000357  00                    	db	0
00000358  207469706F20646520    	db	' tipo de fichero erroneo'
00000370  00                    	db	0
00000371  206E756D65726F2064    	db	' numero de recurso erroneo'
0000038B  00                    	db	0
0000038C  205241544F4E206E6F    	db	' RATON nombre de fichero ya existente'
000003B1  00                    	db	0
000003B2  206E6F206861792064    	db	' no hay descriptores de fichero libres'
000003D8  00                    	db	0
000003D9  206E6F20686120706F    	db	' no ha podido crearse el fichero RATON'
000003FF  00                    	db	0
00000400  5241544F4E            	db	'RATON'
00000405  00                    	db	0
00000406  0A                    	db	10
00000407  0A                    	db	10
00000408  207265637572736F20    	db	' recurso RATON instalado (fichero: RATON)'
00000431  0A                    	db	10
00000432  0A                    	db	10
00000433  207469706F20646520    	db	' tipo de raton = %s'
00000446  0A                    	db	10
00000447  00                    	db	0
00000448  0A                    	db	10
00000449  0A                    	db	10
0000044A  00                    	db	0
0000044B  207469706F20646520    	db	' tipo de recurso erroneo '
00000464  00                    	db	0
00000465  2064656D6173696164    	db	' demasiados vectores de interrupcion '
0000048A  00                    	db	0
0000048B  205241544F4E206E6F    	db	' RATON nombre de recurso ya existente '
000004B1  00                    	db	0
000004B2  206E6F206861792064    	db	' no hay descriptores de recurso libres '
000004D9  00                    	db	0
000004DA  206E756D65726F2064    	db	' numero de vector de interrupcion ya usado '
00000505  00                    	db	0
00000506  206E6F20686120706F    	db	' no ha podido crearse el recurso RATON '
0000052D  00                    	db	0
0000052E  0A                    	db	10
0000052F  00                    	db	0
00000530  2D68                  	db	'-h'
00000532  00                    	db	0
00000533  2D69                  	db	'-i'
00000535  00                    	db	0
00000536  2D71                  	db	'-q'
00000538  00                    	db	0
00000539  2D75                  	db	'-u'
0000053B  00                    	db	0
0000053C  5241544F4E            	db	'RATON'
00000541  00                    	db	0
00000542  207265637572736F20    	db	' recurso RATON desinstalado'
0000055D  00                    	db	0
0000055E  207265637572736F20    	db	' recurso RATON no existe'
00000576  00                    	db	0
00000577  207265637572736F20    	db	' recurso RATON en uso'
0000058C  00                    	db	0
0000058D  206669636865726F20    	db	' fichero RATON no puede destruirse'
000005AF  00                    	db	0
000005B0  205241544F4E206E6F    	db	' RATON no ha podido desinstalarse'
000005D1  00                    	db	0
000005D2  2D69                  	db	'-i'
000005D4  00                    	db	0
000005D5  2D71                  	db	'-q'
000005D7  00                    	db	0
000005D8  0A                    	db	10
000005D9  0A                    	db	10
000005DA  206E756D436F6E736F    	db	' numConsolas debe ser > 0 '
000005F4  0A                    	db	10
000005F5  00                    	db	0
000005F6                        _DATA	ends
00000DE0                        _TEXT	segment byte public 'CODE'
00000DE0                        _TEXT	ends
                                	extrn	_eliminarPC2c:near
                                	extrn	_encolarPC2c:near
                                	extrn	_desencolarPC2c:near
                                	extrn	_inicializarPC2c:near
                                	extrn	_comando:byte
                                	extrn	_simb:word
                                	extrn	_num:word
                                	extrn	_inicScanner:near
                                	extrn	_obtenSimb:near
                                	extrn	_comprobarAmpersand:near
                                	extrn	_exit:near
                                	extrn	_getpindx:near
                                	extrn	_obtenInfoSO1:near
                                	extrn	_crearRecurso:near
                                	extrn	_crearFichero:near
                                	extrn	_esperarDesinstalacion:near
                                	extrn	_destruirRecurso:near
                                	extrn	_obtenInfoINFO:near
                                	extrn	_printf:near
                                	extrn	_escribirCar:near
                                	extrn	_toupper:near
                                	extrn	_strcpy:near
                                	extrn	_strcmpu:near
                                	extrn	_strncmp:near
                                	extrn	_memcpy:near
                                	extrn	_ptrTVI:dword
                                	extrn	_hayWindowsNT:near
                                	extrn	_hayRatonBIOS:near
                                	extrn	_resetRatonBIOS:near
                                	public	_rti_raton_BIOS
                                	extrn	_installMouseEventHandler:near
                                	extrn	_uninstallMouseEventHandler:near
                                	public	_ratonHandler
                                	public	_rec_raton
                                	public	_bloqueadosRaton
                                	public	_e2BloqueadosRaton
                                	public	_nbytesProceso
                                	public	_dirProceso
                                	public	_inB
                                	public	_B
                                	public	_er
                                	public	_XAux
                                	public	_YAux
                                	public	_FAntCursor
                                	public	_CAntCursor
                                	public	_atrAux
                                	public	_cursorRatonActivo
                                	public	_moviendo
                                	public	_redimensionando
                                	public	_primerClick
                                	public	_contTics2Click
                                	public	_huboInt
                                	public	_primeraInt
                                	public	_inicEstadoRaton
                                	public	_leerEstadoRaton
                                	public	_openRaton
                                	public	_releaseRaton
                                	public	_readRaton
                                	public	_aio_readRaton
                                	public	_writeRaton
                                	public	_aio_writeRaton
                                	public	_lseekRaton
                                	public	_fcntlRaton
                                	public	_ioctlRaton
                                	public	_eliminarRaton
                                	public	_procesarRaton
                                	public	_procesarColaBloqueadosRaton
                                	public	_tratarRaton
                                	public	_actualizarCursor
                                	public	_isr_raton
                                	public	_isr_raton_dosbox
                                	public	_rH_CS
                                	public	_rH_IP
                                	public	_rH_AX
                                	public	_rH_BX
                                	public	_rH_CX
                                	public	_rH_DX
                                	public	_rH_SI
                                	public	_rH_DI
                                	public	_isr_raton_BIOS
                                	public	_rti_nVIntRaton
                                	public	_segment_rti_nVIntRaton
                                	public	_offset_rti_nVIntRaton
                                	public	_ptrWordAux
                                	public	_handlerRatonNulo
                                	public	_handlerRaton
                                	public	_finishRaton
                                	public	_finCodeDriver
                                	public	_descCcbRaton
                                	public	_outKBD
                                	public	_flushKBD
                                	public	_setRate
                                	public	_PS2dummy
                                	public	_checkPS2
                                	public	_rtiRatonOrg
                                	public	_disablePS2
                                	public	_enablePS2
                                	public	_noPrintCar
                                	public	_inicRaton
                                	public	_mostrarFormato
                                	public	_formato
                                	public	_help
                                	public	_strTipoRaton
                                	public	_tipoRaton
                                	public	_integrarRaton
                                	public	_desintegrarRaton
                                	public	_instalarRaton
                                	public	_main
                                	extrn	__setargv__:far
                                	end


Macros:

                N a m e                 Type

$comm  . . . . . . . . . . . . .        Proc
@CatStr  . . . . . . . . . . . .        Func
@Environ . . . . . . . . . . . .        Func
@InStr . . . . . . . . . . . . .        Func
@SizeStr . . . . . . . . . . . .        Func
@SubStr  . . . . . . . . . . . .        Func


Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

$$SYMBOLS  . . . . . . . . . . .        32 Bit   00001142 Byte    Private 'DEBSYM'
$$TYPES  . . . . . . . . . . . .        32 Bit   00000004 Byte    Private 'DEBTYP'
_TEXT  . . . . . . . . . . . . .        16 Bit   0DE0     Byte    Public  'CODE'
DGROUP . . . . . . . . . . . . .        GROUP
_DATA  . . . . . . . . . . . . .        16 Bit   05F6     Word    Public  'DATA'
_BSS . . . . . . . . . . . . . .        16 Bit   0008     Word    Public  'BSS'


Procedures, parameters and locals:

                N a m e                 Type     Value    Segment  Length

_PS2dummy  . . . . . . . . . . .        P Far    071B     _TEXT    0001 Public   
_actualizarCursor  . . . . . . .        P Near   04FA     _TEXT    00C3 Public   
_aio_readRaton . . . . . . . . .        P Far    0122     _TEXT    003B Public   
_aio_writeRaton  . . . . . . . .        P Far    0160     _TEXT    0003 Public   
_checkPS2  . . . . . . . . . . .        P Near   071C     _TEXT    0083 Public   
_desintegrarRaton  . . . . . . .        P Near   0BF0     _TEXT    002E Public   
_disablePS2  . . . . . . . . . .        P Near   079F     _TEXT    0027 Public   
_eliminarRaton . . . . . . . . .        P Far    0170     _TEXT    0032 Public   
_enablePS2 . . . . . . . . . . .        P Near   07C6     _TEXT    0033 Public   
_fcntlRaton  . . . . . . . . . .        P Far    016A     _TEXT    0003 Public   
_finCodeDriver . . . . . . . . .        P Near   0685     _TEXT    0001 Public   
_finishRaton . . . . . . . . . .        P Near   067C     _TEXT    0009 Public   
_flushKBD  . . . . . . . . . . .        P Near   06B3     _TEXT    0036 Public   
_formato . . . . . . . . . . . .        P Near   0973     _TEXT    001B Public   
_handlerRaton  . . . . . . . . .        P Far    05BE     _TEXT    00BE Public   
_handlerRatonNulo  . . . . . . .        P Far    05BD     _TEXT    0001 Public   
_help  . . . . . . . . . . . . .        P Near   098E     _TEXT    001A Public   
_inicEstadoRaton . . . . . . . .        P Near   0000     _TEXT    0074 Public   
_inicRaton . . . . . . . . . . .        P Near   07FA     _TEXT    016E Public   
_instalarRaton . . . . . . . . .        P Near   0C1E     _TEXT    004C Public   
_integrarRaton . . . . . . . . .        P Near   09A8     _TEXT    0236 Public   
_ioctlRaton  . . . . . . . . . .        P Far    016D     _TEXT    0003 Public   
_isr_raton . . . . . . . . . . .        P Far    01A2     _TEXT    001C Public   
_isr_raton_BIOS  . . . . . . . .        P Far    01ED     _TEXT    0023 Public   
_isr_raton_dosbox  . . . . . . .        P Far    01BE     _TEXT    002F Public   
_leerEstadoRaton . . . . . . . .        P Near   0074     _TEXT    002D Public   
_lseekRaton  . . . . . . . . . .        P Far    0163     _TEXT    0007 Public   
_main  . . . . . . . . . . . . .        P Near   0C6A     _TEXT    016E Public   
_mostrarFormato  . . . . . . . .        P Near   0968     _TEXT    000B Public   
_noPrintCar  . . . . . . . . . .        P Near   07F9     _TEXT    0001 Public   
_openRaton . . . . . . . . . . .        P Far    00A1     _TEXT    0003 Public   
_outKBD  . . . . . . . . . . . .        P Near   0686     _TEXT    002D Public   
_procesarColaBloqueadosRaton . .        P Near   0415     _TEXT    00E5 Public   
_procesarRaton . . . . . . . . .        P Near   037A     _TEXT    009B Public   
_ratonHandler  . . . . . . . . .        P Far    0242     _TEXT    002B Public   
_readRaton . . . . . . . . . . .        P Far    00A7     _TEXT    007B Public   
_releaseRaton  . . . . . . . . .        P Far    00A4     _TEXT    0003 Public   
_rti_raton_BIOS  . . . . . . . .        P Far    0210     _TEXT    0032 Public   
_setRate . . . . . . . . . . . .        P Near   06E9     _TEXT    0032 Public   
_tratarRaton . . . . . . . . . .        P Near   026D     _TEXT    010D Public   
_writeRaton  . . . . . . . . . .        P Far    015D     _TEXT    0003 Public   


Symbols:

                N a m e                 Type       Value     Attr

$adacdaia  . . . . . . . . . . .        Word             166h _DATA 
$aedcdaia  . . . . . . . . . . .        Word               0h _BSS 
$afpbdaia  . . . . . . . . . . .        Word             162h _DATA 
$akacdaia  . . . . . . . . . . .        Word             16Ah _DATA 
$aoobdaia  . . . . . . . . . . .        Byte             160h _DATA 
$ibpbdaia  . . . . . . . . . . .        Byte             161h _DATA 
$igacdaia  . . . . . . . . . . .        Word             168h _DATA 
$iipbdaia  . . . . . . . . . . .        Word             164h _DATA 
??version  . . . . . . . . . . .        Text   0504
?debug . . . . . . . . . . . . .        Text   ;
@12@8  . . . . . . . . . . . . .        L Near           19Dh _TEXT 
@18@14 . . . . . . . . . . . . .        L Near           2E6h _TEXT 
@18@15 . . . . . . . . . . . . .        L Near           2EEh _TEXT 
@18@18 . . . . . . . . . . . . .        L Near           30Dh _TEXT 
@18@23 . . . . . . . . . . . . .        L Near           32Ah _TEXT 
@18@24 . . . . . . . . . . . . .        L Near           332h _TEXT 
@18@27 . . . . . . . . . . . . .        L Near           365h _TEXT 
@18@28 . . . . . . . . . . . . .        L Near           379h _TEXT 
@18@8  . . . . . . . . . . . . .        L Near           2A0h _TEXT 
@19@4  . . . . . . . . . . . . .        L Near           3F4h _TEXT 
@19@6  . . . . . . . . . . . . .        L Near           403h _TEXT 
@19@8  . . . . . . . . . . . . .        L Near           410h _TEXT 
@19@9  . . . . . . . . . . . . .        L Near           413h _TEXT 
@20@4  . . . . . . . . . . . . .        L Near           498h _TEXT 
@20@6  . . . . . . . . . . . . .        L Near           4F7h _TEXT 
@21@10 . . . . . . . . . . . . .        L Near           570h _TEXT 
@21@15 . . . . . . . . . . . . .        L Near           5BCh _TEXT 
@21@3  . . . . . . . . . . . . .        L Near           514h _TEXT 
@21@5  . . . . . . . . . . . . .        L Near           529h _TEXT 
@23@10 . . . . . . . . . . . . .        L Near           5FBh _TEXT 
@23@12 . . . . . . . . . . . . .        L Near           608h _TEXT 
@23@14 . . . . . . . . . . . . .        L Near           62Ah _TEXT 
@23@16 . . . . . . . . . . . . .        L Near           639h _TEXT 
@23@17 . . . . . . . . . . . . .        L Near           63Fh _TEXT 
@23@19 . . . . . . . . . . . . .        L Near           64Dh _TEXT 
@23@21 . . . . . . . . . . . . .        L Near           674h _TEXT 
@23@22 . . . . . . . . . . . . .        L Near           67Ah _TEXT 
@23@7  . . . . . . . . . . . . .        L Near           5DBh _TEXT 
@23@8  . . . . . . . . . . . . .        L Near           5EEh _TEXT 
@26@18 . . . . . . . . . . . . .        L Near           6ABh _TEXT 
@26@6  . . . . . . . . . . . . .        L Near           694h _TEXT 
@26@9  . . . . . . . . . . . . .        L Near           699h _TEXT 
@27@10 . . . . . . . . . . . . .        L Near           6CFh _TEXT 
@27@18 . . . . . . . . . . . . .        L Near           6DBh _TEXT 
@27@3  . . . . . . . . . . . . .        L Near           6C6h _TEXT 
@27@7  . . . . . . . . . . . . .        L Near           6CAh _TEXT 
@2@5 . . . . . . . . . . . . . .        L Near            9Dh _TEXT 
@2@6 . . . . . . . . . . . . . .        L Near            9Fh _TEXT 
@30@33 . . . . . . . . . . . . .        L Near           79Bh _TEXT 
@34@10 . . . . . . . . . . . . .        L Near           851h _TEXT 
@34@12 . . . . . . . . . . . . .        L Near           861h _TEXT 
@34@15 . . . . . . . . . . . . .        L Near           8A5h _TEXT 
@34@17 . . . . . . . . . . . . .        L Near           8B5h _TEXT 
@34@20 . . . . . . . . . . . . .        L Near           8D0h _TEXT 
@34@22 . . . . . . . . . . . . .        L Near           8DDh _TEXT 
@34@23 . . . . . . . . . . . . .        L Near           8E2h _TEXT 
@34@26 . . . . . . . . . . . . .        L Near           8FDh _TEXT 
@34@28 . . . . . . . . . . . . .        L Near           924h _TEXT 
@34@29 . . . . . . . . . . . . .        L Near           93Ch _TEXT 
@34@30 . . . . . . . . . . . . .        L Near           93Eh _TEXT 
@34@32 . . . . . . . . . . . . .        L Near           94Eh _TEXT 
@34@33 . . . . . . . . . . . . .        L Near           954h _TEXT 
@34@6  . . . . . . . . . . . . .        L Near           81Dh _TEXT 
@34@7  . . . . . . . . . . . . .        L Near           823h _TEXT 
@38@12 . . . . . . . . . . . . .        L Near           B40h _TEXT 
@38@13 . . . . . . . . . . . . .        L Near           B46h _TEXT 
@38@14 . . . . . . . . . . . . .        L Near           B4Ch _TEXT 
@38@15 . . . . . . . . . . . . .        L Near           B52h _TEXT 
@38@16 . . . . . . . . . . . . .        L Near           B58h _TEXT 
@38@17 . . . . . . . . . . . . .        L Near           B5Ch _TEXT 
@38@19 . . . . . . . . . . . . .        L Near           B6Ch _TEXT 
@38@21 . . . . . . . . . . . . .        L Near           B86h _TEXT 
@38@22 . . . . . . . . . . . . .        L Near           B8Ah _TEXT 
@38@26 . . . . . . . . . . . . .        L Near           BA7h _TEXT 
@38@27 . . . . . . . . . . . . .        L Near           BADh _TEXT 
@38@28 . . . . . . . . . . . . .        L Near           BB3h _TEXT 
@38@29 . . . . . . . . . . . . .        L Near           BB9h _TEXT 
@38@30 . . . . . . . . . . . . .        L Near           BBFh _TEXT 
@38@31 . . . . . . . . . . . . .        L Near           BC5h _TEXT 
@38@32 . . . . . . . . . . . . .        L Near           BC9h _TEXT 
@38@6  . . . . . . . . . . . . .        L Near           B09h _TEXT 
@38@C92  . . . . . . . . . . . .        Word             BE8h _TEXT 
@38@C97  . . . . . . . . . . . .        Word             BDEh _TEXT 
@39@6  . . . . . . . . . . . . .        L Near           C08h _TEXT 
@39@7  . . . . . . . . . . . . .        L Near           C16h _TEXT 
@39@8  . . . . . . . . . . . . .        L Near           C19h _TEXT 
@40@3  . . . . . . . . . . . . .        L Near           C30h _TEXT 
@40@5  . . . . . . . . . . . . .        L Near           C4Ch _TEXT 
@40@6  . . . . . . . . . . . . .        L Near           C65h _TEXT 
@41@11 . . . . . . . . . . . . .        L Near           CABh _TEXT 
@41@12 . . . . . . . . . . . . .        L Near           CC0h _TEXT 
@41@14 . . . . . . . . . . . . .        L Near           CC6h _TEXT 
@41@16 . . . . . . . . . . . . .        L Near           CDDh _TEXT 
@41@18 . . . . . . . . . . . . .        L Near           CE5h _TEXT 
@41@23 . . . . . . . . . . . . .        L Near           D19h _TEXT 
@41@24 . . . . . . . . . . . . .        L Near           D1Fh _TEXT 
@41@25 . . . . . . . . . . . . .        L Near           D25h _TEXT 
@41@26 . . . . . . . . . . . . .        L Near           D2Bh _TEXT 
@41@27 . . . . . . . . . . . . .        L Near           D31h _TEXT 
@41@28 . . . . . . . . . . . . .        L Near           D35h _TEXT 
@41@30 . . . . . . . . . . . . .        L Near           D40h _TEXT 
@41@34 . . . . . . . . . . . . .        L Near           D79h _TEXT 
@41@39 . . . . . . . . . . . . .        L Near           DB4h _TEXT 
@41@4  . . . . . . . . . . . . .        L Near           C7Ah _TEXT 
@41@41 . . . . . . . . . . . . .        L Near           DCDh _TEXT 
@41@42 . . . . . . . . . . . . .        L Near           DCFh _TEXT 
@41@43 . . . . . . . . . . . . .        L Near           DD3h _TEXT 
@41@7  . . . . . . . . . . . . .        L Near           C85h _TEXT 
@41@C97  . . . . . . . . . . . .        Word             DD8h _TEXT 
@5@8 . . . . . . . . . . . . . .        L Near            CEh _TEXT 
@5@9 . . . . . . . . . . . . . .        L Near            D3h _TEXT 
@6@8 . . . . . . . . . . . . . .        L Near           13Fh _TEXT 
@6@9 . . . . . . . . . . . . . .        L Near           144h _TEXT 
@@0  . . . . . . . . . . . . . .        L Near           282h _TEXT 
@@1  . . . . . . . . . . . . . .        L Near           2A0h _TEXT 
@@2  . . . . . . . . . . . . . .        L Near           2C3h _TEXT 
@@3  . . . . . . . . . . . . . .        L Near           424h _TEXT 
@@4  . . . . . . . . . . . . . .        L Near           504h _TEXT 
@@5  . . . . . . . . . . . . . .        L Near           529h _TEXT 
@@6  . . . . . . . . . . . . . .        L Near           8C0h _TEXT 
@@7  . . . . . . . . . . . . . .        L Near           B13h _TEXT 
@@8  . . . . . . . . . . . . . .        L Near           C8Eh _TEXT 
@@9  . . . . . . . . . . . . . .        L Near           D4Fh _TEXT 
_B . . . . . . . . . . . . . . .        Byte             106h _DATA Public 
_CAntCursor  . . . . . . . . . .        Word             132h _DATA Public 
_FAntCursor  . . . . . . . . . .        Word             130h _DATA Public 
_SP0_SO1 . . . . . . . . . . . .        Word              36h _DATA 
_XAux  . . . . . . . . . . . . .        Word             12Ch _DATA Public 
_YAux  . . . . . . . . . . . . .        Word             12Eh _DATA Public 
__setargv__  . . . . . . . . . .        L Far16            0h External 
_activarProceso  . . . . . . . .        DWord             48h _DATA 
_atrAux  . . . . . . . . . . . .        Byte             134h _DATA Public 
_bloqueadosRaton . . . . . . . .        Word              56h _DATA Public 
_bloquearProcesoActual . . . . .        DWord             50h _DATA 
_buscarNuevoProcesoActual  . . .        DWord             4Ch _DATA 
_comando . . . . . . . . . . . .        Byte               0h External 
_comprobarAmpersand  . . . . . .        L Near16           0h External 
_contTics2Click  . . . . . . . .        Word             13Eh _DATA Public 
_crearFichero  . . . . . . . . .        L Near16           0h External 
_crearRecurso  . . . . . . . . .        L Near16           0h External 
_cursorRatonActivo . . . . . . .        Word             136h _DATA Public 
_descCcbRaton  . . . . . . . . .        Word             16Ch _DATA Public 
_desencolarPC2c  . . . . . . . .        L Near16           0h External 
_destruirRecurso . . . . . . . .        L Near16           0h External 
_dirProceso  . . . . . . . . . .        DWord             C4h _DATA Public 
_e2BloqueadosRaton . . . . . . .        Word              60h _DATA Public 
_eliminarPC2c  . . . . . . . . .        L Near16           0h External 
_encolarPC2c . . . . . . . . . .        L Near16           0h External 
_er  . . . . . . . . . . . . . .        Word             109h _DATA Public 
_escribirCar . . . . . . . . . .        L Near16           0h External 
_esperarDesinstalacion . . . . .        L Near16           0h External 
_exit  . . . . . . . . . . . . .        L Near16           0h External 
_getpindx  . . . . . . . . . . .        L Near16           0h External 
_hayRatonBIOS  . . . . . . . . .        L Near16           0h External 
_hayWindowsNT  . . . . . . . . .        L Near16           0h External 
_huboInt . . . . . . . . . . . .        Word             140h _DATA Public 
_inB . . . . . . . . . . . . . .        Word             104h _DATA Public 
_inicScanner . . . . . . . . . .        L Near16           0h External 
_inicializarPC2c . . . . . . . .        L Near16           0h External 
_installMouseEventHandler  . . .        L Near16           0h External 
_memcpy  . . . . . . . . . . . .        L Near16           0h External 
_moviendo  . . . . . . . . . . .        Word             138h _DATA Public 
_nbytesProceso . . . . . . . . .        Word              A4h _DATA Public 
_num . . . . . . . . . . . . . .        Word               0h External 
_obtenInfoINFO . . . . . . . . .        L Near16           0h External 
_obtenInfoSO1  . . . . . . . . .        L Near16           0h External 
_obtenSimb . . . . . . . . . . .        L Near16           0h External 
_offset_rti_nVIntRaton . . . . .        Word             15Ah _DATA Public 
_primerClick . . . . . . . . . .        Word             13Ch _DATA Public 
_primeraInt  . . . . . . . . . .        Word             142h _DATA Public 
_printf  . . . . . . . . . . . .        L Near16           0h External 
_ptrActivarAlEpilogo . . . . . .        DWord              8h _DATA 
_ptrC2cPFR . . . . . . . . . . .        DWord             1Ah _DATA 
_ptrCcbAlEpilogo . . . . . . . .        DWord             2Ah _DATA 
_ptrContRodajas  . . . . . . . .        DWord             38h _DATA 
_ptrContTicsRodaja . . . . . . .        DWord             3Ch _DATA 
_ptrDescFichero  . . . . . . . .        DWord             12h _DATA 
_ptrDescProceso  . . . . . . . .        DWord              Ch _DATA 
_ptrDescRecurso  . . . . . . . .        DWord             16h _DATA 
_ptrEnHalt . . . . . . . . . . .        DWord             22h _DATA 
_ptrHayTic . . . . . . . . . . .        DWord             26h _DATA 
_ptrIndProcesoActual . . . . . .        DWord              0h _DATA 
_ptrNivelActivacionSO1 . . . . .        DWord             1Eh _DATA 
_ptrSP_Proceso . . . . . . . . .        DWord             32h _DATA 
_ptrSS_Proceso . . . . . . . . .        DWord             2Eh _DATA 
_ptrTVI  . . . . . . . . . . . .        DWord              0h External 
_ptrTramaProceso . . . . . . . .        DWord              4h _DATA 
_ptrVIOrg  . . . . . . . . . . .        DWord             40h _DATA 
_ptrWordAux  . . . . . . . . . .        DWord            15Ch _DATA Public 
_rH_AX . . . . . . . . . . . . .        Word             148h _DATA Public 
_rH_BX . . . . . . . . . . . . .        Word             14Ah _DATA Public 
_rH_CS . . . . . . . . . . . . .        Word             144h _DATA Public 
_rH_CX . . . . . . . . . . . . .        Word             14Ch _DATA Public 
_rH_DI . . . . . . . . . . . . .        Word             152h _DATA Public 
_rH_DX . . . . . . . . . . . . .        Word             14Eh _DATA Public 
_rH_IP . . . . . . . . . . . . .        Word             146h _DATA Public 
_rH_SI . . . . . . . . . . . . .        Word             150h _DATA Public 
_rec_raton . . . . . . . . . . .        Word              54h _DATA Public 
_redimensionando . . . . . . . .        Word             13Ah _DATA Public 
_resetRatonBIOS  . . . . . . . .        L Near16           0h External 
_rtiRatonOrg . . . . . . . . . .        DWord              2h _BSS Public 
_rti_nVIntRaton  . . . . . . . .        DWord            154h _DATA Public 
_segment_rti_nVIntRaton  . . . .        Word             158h _DATA Public 
_sigProceso  . . . . . . . . . .        DWord             44h _DATA 
_simb  . . . . . . . . . . . . .        Word               0h External 
_strTipoRaton  . . . . . . . . .        Byte             19Ch _DATA Public 
_strcmpu . . . . . . . . . . . .        L Near16           0h External 
_strcpy  . . . . . . . . . . . .        L Near16           0h External 
_strncmp . . . . . . . . . . . .        L Near16           0h External 
_tamDescProceso  . . . . . . . .        Word              10h _DATA 
_tipoRaton . . . . . . . . . . .        Word               6h _BSS Public 
_toupper . . . . . . . . . . . .        L Near16           0h External 
_uninstallMouseEventHandler  . .        L Near16           0h External 
b@ . . . . . . . . . . . . . . .        Byte               0h _BSS 
b@w  . . . . . . . . . . . . . .        Word               0h _BSS 
d@ . . . . . . . . . . . . . . .        Byte               0h _DATA 
d@w  . . . . . . . . . . . . . .        Word               0h _DATA 
flushKBD_0 . . . . . . . . . . .        L Near           6C6h _TEXT 
flushKBD_1 . . . . . . . . . . .        L Near           6CAh _TEXT 
flushKBD_2 . . . . . . . . . . .        L Near           6CFh _TEXT 
flushKBD_3 . . . . . . . . . . .        L Near           6DBh _TEXT 
outKBD_0 . . . . . . . . . . . .        L Near           694h _TEXT 
outKBD_1 . . . . . . . . . . . .        L Near           699h _TEXT 
outKBD_2 . . . . . . . . . . . .        L Near           6ABh _TEXT 
s@ . . . . . . . . . . . . . . .        Byte             1B4h _DATA 

raton_ms.asm: 4790 lines, 4 passes, 31 ms, 0 warnings, 0 errors
